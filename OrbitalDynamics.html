
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Orbital Dynamics &#8212; Physics 246</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'OrbitalDynamics';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exoplanets" href="Exoplanets_short.html" />
    <link rel="prev" title="Dynamics" href="Dynamics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/FD.png" class="logo__image only-light" alt="Physics 246 - Home"/>
    <script>document.write(`<img src="_static/FD.png" class="logo__image only-dark" alt="Physics 246 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An Introduction to Modern Computational Physics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="N_Ways_of_Measuring_PI.html">N ways to measure <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Orbital Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exoplanets_short.html">Exoplanets</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaos.html">Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticlePhysics.html">Particle Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearningGalaxies.html">Classifying Galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Random%20Walks.html">Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Markov%20Chains.html">Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="Predator-Prey.html">Predator-Prey</a></li>
<li class="toctree-l1"><a class="reference internal" href="Climate.html">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="FluidDynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC1.html">Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2.html">Building a Physical Qubit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/lkwagner/IntroductionToComputationalPhysics/blob/main/IntroductionToComputationalPhysics/OrbitalDynamics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/OrbitalDynamics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Orbital Dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warmups">Warmups</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#planetary-parameters">Planetary Parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-orbital-dynamics">Exercise 1. Orbital Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-plot-a-model-of-the-solar-system">a. Plot a model of the solar system.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-modify-your-code-to-include-the-force-of-gravity">b. Modify your code to include the force of gravity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-earth-orbiting-the-sun">c.  Earth Orbiting the Sun</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-animation">d. Animation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-geosyncronous-orbit-extra-credit-5-points">e. Geosyncronous Orbit (Extra Credit: 5 Points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-kepler-s-laws">Exercise 2. Kepler‚Äôs Laws</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-law-2">a. Law 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-law-1-extra-credit-10-points">b. Law 1 (Extra Credit: 10 points)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-law-3-extra-credit-10-points">c. Law 3: (Extra Credit: 10 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-just-information-no-work-on-this-problem">Background (just information‚Ä¶no work on this problem)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-mercury-precession">Exercise 3: Mercury Precession</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-mercury-without-general-relativity">a.  Mercury without general relativity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-interpolating-to-find-the-precession">b. Interpolating to find the  precession</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-mercury-with-general-relativity">c.  Mercury with general relativity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-transfer-orbits-extra-credit-5-points">Exercise 4. Transfer Orbits (Extra Credit: 5 points)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="orbital-dynamics">
<h1>Orbital Dynamics<a class="headerlink" href="#orbital-dynamics" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this assignment we will learn how to simulate the orbital dynamics of a planet going around the sun (which we assume to be fixed).  We will then proceed to use simulation to test two of the most important physics results in the last 400 years.</p>
<p>First, we will numerically validate Kepler‚Äôs Second Law: a planet sweeps out the same area of its orbit in equal time.  Kepler‚Äôs first law (all planets ü™ê orbit in ellipses) and Kepler‚Äôs third law (the square of the orbital period of a planet is directly proportional to the cube of the semi-major axis of its orbit) will be left as extra credit.</p>
<p>Then we will see that general relativity alters the Newtonian law of gravitation in such a way that the planets no longer move in ellipses.  Instead, their closest approach to the sun (the perihelion) changes its location slightly as you go around the Sun.  Mesuring this effect in Mercury was one of the key original validations of general relativity.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;math&#39;</span><span class="p">,</span><span class="s1">&#39;jax&#39;</span><span class="p">,</span><span class="s1">&#39;jnp&#39;</span><span class="p">,</span><span class="s1">&#39;jit&#39;</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="k">return</span>
<span class="c1">#resetMe()</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2026, 2, 5, 21, 43, 58, 732980)
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="warmups">
<h2>Warmups<a class="headerlink" href="#warmups" title="Link to this heading">#</a></h2>
<section id="planetary-parameters">
<h3>Planetary Parameters<a class="headerlink" href="#planetary-parameters" title="Link to this heading">#</a></h3>
<p>When you have a lot of parameters, it is often more convenient to use a dataclass
to hold them. This way you can access them with dot notation instead of dictionary notation.
It also only takes up one variable in your namespace.
Here‚Äôs how to do it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#resetMe()</span>
<span class="n">SolarSystemParameters</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;MercuryOrbitRadius&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">57.9e9</span> <span class="c1">#meters</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;MercuryPerihelion&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">46.0012e9</span> <span class="c1"># meters</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;MercuryAphelion&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">69.8169e9</span> <span class="c1"># meters</span>

<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;EarthRadius&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">6.371e6</span> <span class="c1">#meters</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;EarthRotatingVelocity&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">444.444</span> <span class="c1"># meters per second</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;EarthOrbitRadius&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">149.6e9</span> <span class="c1"># meters</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;EarthOrbitVelocity&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">29.8e3</span> <span class="c1"># meters per second</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;EarthMass&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">5.972e24</span> <span class="c1"># kg</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;MoonOrbitRadius&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">363228.9e3</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;MoonMass&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">7.34e22</span> <span class="c1"># kg</span>

<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;SunRadius&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">695.51e3</span> <span class="c1">#meters</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;SunMass&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">1.989e30</span> <span class="c1"># kg</span>
<span class="n">SolarSystemParameters</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">6.67408e-11</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SolarSystemParameters</span><span class="p">:</span>
    <span class="n">MecuryOrbitRadius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">57.9e9</span> <span class="c1">#meters</span>
    <span class="n">MercuryPerihelion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">46.0012e9</span> <span class="c1"># meters</span>
    <span class="n">MercuryAphelion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">69.8169e9</span> <span class="c1"># meters</span>
    <span class="n">EarthRadius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.371e6</span> <span class="c1">#meters</span>
    <span class="n">EarthRotatingVelocity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">444.444</span> <span class="c1"># meters per second</span>
    <span class="n">EarthOrbitRadius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">149.6e9</span> <span class="c1"># meters</span>
    <span class="n">EarthOrbitVelocity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">29.8e3</span> <span class="c1"># meters per second</span>
    <span class="n">EarthMass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.972e24</span> <span class="c1"># kg</span>
    <span class="n">MoonOrbitRadius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">363228.9e3</span> <span class="c1"># meters</span>
    <span class="n">MoonMass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.34e22</span> <span class="c1"># kg</span>
    <span class="n">SunRadius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">695.51e6</span> <span class="c1">#meters</span>
    <span class="n">SunMass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.989e30</span> <span class="c1"># kg</span>
    <span class="n">G</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.67408e-11</span>  <span class="c1"># m^3 kg^-1 s^-2</span>

<span class="n">SSP</span> <span class="o">=</span> <span class="n">SolarSystemParameters</span><span class="p">()</span> <span class="c1"># create an instance of the dataclass</span>

<span class="c1">## access the parameters like this:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SSP</span><span class="o">.</span><span class="n">EarthMass</span><span class="p">)</span>
<span class="c1">## You should get autocomplete depending on your editor; you might need to hit tab after typing `SSP.`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.972e+24
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-1-orbital-dynamics">
<h2>Exercise 1. Orbital Dynamics<a class="headerlink" href="#exercise-1-orbital-dynamics" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<section id="a-plot-a-model-of-the-solar-system">
<h3>a. Plot a model of the solar system.<a class="headerlink" href="#a-plot-a-model-of-the-solar-system" title="Link to this heading">#</a></h3>
<p>ü¶â Use these parameters to plot a model of our solar system which includes the Sun, Earth and Mercury assuming that the planets orbit in circular motion.  (this doesn‚Äôt involve any simulations just plotting things to scale.)</p>
</section>
<section id="b-modify-your-code-to-include-the-force-of-gravity">
<h3>b. Modify your code to include the force of gravity<a class="headerlink" href="#b-modify-your-code-to-include-the-force-of-gravity" title="Link to this heading">#</a></h3>
<p>In Newton‚Äôs model the earth‚Äôs gravity is a central force that exerts an attractive pull</p>
<div class="math notranslate nohighlight">
\[\vec{F}(\vec{r}) = m\vec{a}(\vec{r}) = -\frac{Gm_\textrm{earth}m}{r^2}\hat{r}\]</div>
<p>between the earth and another mass m. In the formula G is Newton‚Äôs constant, <span class="math notranslate nohighlight">\(6.674 \times 10^{-11} m^3/\textrm{kg}/\textrm{sec}^2\)</span>. The mass of the earth is approximately <span class="math notranslate nohighlight">\(5.972 \times 10^{24}\)</span> kg.  Because the gravitational force from the earth is proportional to an object‚Äôs mass, its gravitationally induced acceleration is independent of its mass.</p>
<p>Let‚Äôs place the origin of a right handed coordinate system at the earth‚Äôs center, with the equator lying in the x,y plane and the x axis passing through <span class="math notranslate nohighlight">\(0^{\circ}\)</span> longitude. To simplify things let‚Äôs assume that the orbit of any object of interest lies in the <span class="math notranslate nohighlight">\(x,y\)</span> plane. As you can see in the following figure, the angle œÜ is taken with respect to the x axis. We are fixing <span class="math notranslate nohighlight">\(\theta = 90^{\circ}\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/coord.png" width=400 alt="coordinate frame"></img><br></div><p>We can write the <span class="math notranslate nohighlight">\(x, y\)</span> components of the gravitational acceleration as</p>
<div class="math notranslate nohighlight">
\[a_x = -\frac{Gm_\textrm{sun} }{x^2+y^2}\cos \phi = - \frac{Gm_\textrm{sun} x }{(x^2+y^2)^{3/2}}\]</div>
<div class="math notranslate nohighlight">
\[a_y = -\frac{Gm_\textrm{sun} }{x^2+y^2}\sin \phi = - \frac{Gm_\textrm{sun} y }{(x^2+y^2)^{3/2}}\]</div>
<p>Note that you can write this in vector notation so that you don‚Äôt have to do <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> separately!</p>
<p>Copy over your previous work from the Dynamics homework for an integrator (we recommend the midpoint method).  Assuming the sun is at (0,0) modify your force function to implement the gravitational force.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">orbit_classical</span><span class="p">(</span><span class="n">initial_pos</span><span class="p">,</span> <span class="n">initial_vel</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">SSP</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run an orbit for a total of T time using classical mechanics (no special relativity). </span>
<span class="sd">    If the radius is ever less than SSP.SunRadius stop the simulation, since it has crashed into the Sun.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        initial_pos: (2,)</span>
<span class="sd">        initial_vel: (2,) initial velocity (m/s)</span>
<span class="sd">        dt: timestep (s)</span>
<span class="sd">        T: total time (s)</span>
<span class="sd">        SSP: solar system parameters</span>
<span class="sd">    Returns:</span>
<span class="sd">        times: (nsteps,)</span>
<span class="sd">        positions: (nsteps, 2)</span>
<span class="sd">        velocities: (nsteps, 2)</span>
<span class="sd">    where nsteps=int(np.ceil(T/dT))</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>ü¶âModify your code to correctly incorporate gravity. There will be nothing to run here just the functions (you will make plots below)</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-earth-orbiting-the-sun">
<h3>c.  Earth Orbiting the Sun<a class="headerlink" href="#c-earth-orbiting-the-sun" title="Link to this heading">#</a></h3>
<p>ü¶â Write some code to set up the parameters of the Earth orbiting the sun and then plot it.  Use a dt of 3600 seconds.  You should be able to plot it as <code class="docutils literal notranslate"><span class="pre">plt.plot(positions[:,0],positions[:,1])</span></code>. Confirm that it does indeed orbit once per year.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="d-animation">
<h3>d. Animation<a class="headerlink" href="#d-animation" title="Link to this heading">#</a></h3>
<p>ü¶â Run the code below to plot an animation of your orbit.  Your coordinates have to be in positions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>

<span class="k">def</span><span class="w"> </span><span class="nf">animateMe</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span><span class="n">fullLine</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="c1"># First set up the figure, the axis, and the plot element we want to animate</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span>
    <span class="n">x_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>
    <span class="n">y_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">));</span>
    <span class="c1">#line, = ax.plot([], [], lw=2);</span>
    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="c1"># initialization function: plot the background of each frame</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
        <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="n">line</span><span class="p">,</span>

    <span class="c1"># animation function.  This is called sequentially</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fullLine</span><span class="p">:</span>
            <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#        line.set_markersize(10)</span>
        <span class="k">return</span> <span class="n">line</span><span class="p">,</span>

    <span class="c1"># call the animator.  blit=True means only re-draw the parts that have changed.</span>
    <span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
                                   <span class="n">frames</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                   <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">anim</span>
<span class="n">steps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">pos</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">anim</span><span class="o">=</span><span class="n">animateMe</span><span class="p">(</span><span class="n">pos</span><span class="p">[::</span><span class="n">steps</span><span class="o">//</span><span class="mi">100</span><span class="p">],</span><span class="kc">True</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_jshtml</span><span class="p">())</span>

</pre></div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="e-geosyncronous-orbit-extra-credit-5-points">
<h3>e. Geosyncronous Orbit (Extra Credit: 5 Points)<a class="headerlink" href="#e-geosyncronous-orbit-extra-credit-5-points" title="Link to this heading">#</a></h3>
<p>ü¶âDetermine the height a spaceship needs to be above the surface of the Earth to be in circular Geosynchronous orbit. A geosynchronous orbit is one that stays over the same point of Earth for the entire orbit.   To determine this, we need to set up our orbit simulation to run for an Earth/Satellite simulation.</p>
<p>A useful thing to know is that the velocity that you need to apply tangeant to a circular orbit to stay in a circular orbit of radius <span class="math notranslate nohighlight">\(r\)</span> is</p>
<div class="math notranslate nohighlight">
\[ v = \sqrt{\frac{GM}{r}} \]</div>
<p>Then compute the orbit of that trajectory.  To show that it‚Äôs geosynchronous you want it to produce an orbit that is a circle in one day.  You can make your <code class="docutils literal notranslate"><span class="pre">m</span></code> small (say 100 kg).  I recommend a <code class="docutils literal notranslate"><span class="pre">dt</span></code> of 1 second.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<hr class="docutils" />
<section id="exercise-2-kepler-s-laws">
<h2>Exercise 2. Kepler‚Äôs Laws<a class="headerlink" href="#exercise-2-kepler-s-laws" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>Kepler developed three laws about planetary motion (using data from Tycho Brahe on planetary motion).  In this exercise you will explicitly check Kepler‚Äôs laws.</p>
<p>The three laws are (from <a class="reference external" href="https://en.wikipedia.org/wiki/Kepler%27s_laws_of_planetary_motion">wikipedia</a>):</p>
<p>(1) The orbit of a planet is an ellipse with the Sun at one of the two foci.</p>
<p>(2) A line segment joining a planet and the Sun sweeps out equal areas during equal intervals of time.</p>
<p>(3) The square of the orbital period of a planet is directly proportional to the cube of the semi-major axis of its orbit.</p>
<section id="a-law-2">
<h3>a. Law 2<a class="headerlink" href="#a-law-2" title="Link to this heading">#</a></h3>
<p>Kepler‚Äôs second law tells us that the planet sweeps out the same ‚Äúarea‚Äù of the ellipse in a fixed amount of time.<br />
ü¶âVerify this by computing (and plotting) the area swept out in these two regions:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(0.2 T_\textrm{orbit}&lt;t&lt;0.2T_\textrm{orbit}+0.1T_\textrm{orbit}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(0.6 T_\textrm{orbit}&lt;t&lt;0.6 T_\textrm{orbit}+0.1T_\textrm{orbit}\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(T_\textrm{orbit}\)</span> is the total time for an orbit.  Use Earth‚Äôs orbit to do this and a time-step of 1 hour.</p>
<p>To compute the area, I summed a bunch of triangles that make up the points on the orbit.  To that end I found it useful to write a <code class="docutils literal notranslate"><span class="pre">triangle_area</span></code> function.</p>
<p>Here is an example of the area sweeped out for 0.1T of an orbit at different times (<strong>but note that this is for a random orbit and not Earth‚Äôs orbit!</strong>):</p>
<div><img src="https://clark.physics.illinois.edu/246img/KeplerSecond.png" width=600  alt="Kepler Second Law"></img><br></div><p>You should report what your two areas are.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-law-1-extra-credit-10-points">
<h3>b. Law 1 (Extra Credit: 10 points)<a class="headerlink" href="#b-law-1-extra-credit-10-points" title="Link to this heading">#</a></h3>
<p>The first law tells us that:</p>
<ol class="arabic simple">
<li><p>the orbit is an ellipse and</p></li>
<li><p>the sun is at a focus.</p></li>
</ol>
<p>You want to write two functions, each of which checks one of these criteria.</p>
<p>ü¶âTo check this,</p>
<ul class="simple">
<li><p>Modify the constants in your code to emulate planets (i.e. let <code class="docutils literal notranslate"><span class="pre">M</span></code> be the mass of the sun, <span class="math notranslate nohighlight">\(M_\textrm{sun} = 1.989 \times 10^{30}\)</span> kg)</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">dt</span></code> be an hour</p></li>
<li><p>Emulate some eccentric orbits.  To do this, change the initial velocity by a little bit.  This will give you eccentric orbits.</p></li>
<li><p>Check that the orbit you get is an ellipse with the sun is a focus.</p></li>
</ul>
<p>To check that you have an ellipse, we should verify that the points (<code class="docutils literal notranslate"><span class="pre">positions</span></code>) satisfy the general equation for an ellipse.</p>
<p>The general equation for an ellipse (<a class="reference external" href="https://math.stackexchange.com/questions/426150/what-is-the-general-equation-of-the-ellipse-that-is-not-in-the-origin-and-rotate">stackexchange</a>) is
$<span class="math notranslate nohighlight">\( \frac{((x-h)\cos(A) + (y-k)\sin(A))^2}{a^2} + \frac{((x-h)\sin(A) - (y-k)\cos(A))^2}{b^2} =1,\)</span><span class="math notranslate nohighlight">\(
where \)</span>a<span class="math notranslate nohighlight">\( is the length of the semi-major axis, \)</span>b<span class="math notranslate nohighlight">\( is the length of the semi-minor axis, \)</span>(h,k)<span class="math notranslate nohighlight">\( is the center of the ellipse and \)</span>A$ is the angle of the ellipse.</p>
<p>Given a focus, we can compute the points closest and further from the loci, <span class="math notranslate nohighlight">\(p_{min}\)</span> and <span class="math notranslate nohighlight">\(p_{max}\)</span> which are at distance <span class="math notranslate nohighlight">\(r_{min}\)</span> and <span class="math notranslate nohighlight">\(r_{max}\)</span>.</p>
<p>With these we can compute</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a=\frac{r_\textrm{min}+r_\textrm{max}}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b=\sqrt{r_\textrm{min}r_\textrm{max}}\)</span></p></li>
<li><p>the center <span class="math notranslate nohighlight">\((h,k) = (p_\textrm{max}+p_\textrm{min})/2\)</span>.</p></li>
<li><p>the semi-major axis <span class="math notranslate nohighlight">\(\vec{a}=(p_\textrm{max}-p_\textrm{min})\)</span></p></li>
<li><p>the angle <span class="math notranslate nohighlight">\(A=\tan^{-1}[\vec{a}(1)/\vec{a}(0)]\)</span></p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-law-3-extra-credit-10-points">
<h3>c. Law 3: (Extra Credit: 10 points)<a class="headerlink" href="#c-law-3-extra-credit-10-points" title="Link to this heading">#</a></h3>
<p>Kepler‚Äôs third law tells us that the square of the orbital period of a planet is directly proportional to the cube of the semi-major axis of its orbit.</p>
<p>In other words, <span class="math notranslate nohighlight">\(T^2 \propto a^3\)</span>.</p>
<p><em>From Wikipedia quoting Kepler on finding the third law:</em></p>
<div><img src="https://clark.physics.illinois.edu/246img/KeplerQuote.png" width=600  alt="Kepler Second Law"></img><br></div>
<p>ü¶âVerify Kepler‚Äôs third law by computing the orbital period <span class="math notranslate nohighlight">\(T\)</span> (write a function that finds when your orbit gets back to its starting place) and the semi-major axis (as you did above) for 25 different orbits.  To generate these orbits use random initial starting velocities of the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v_circ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">M</span><span class="o">/</span><span class="n">r0</span><span class="p">)</span>
<span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="n">v_circ</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">*</span><span class="n">v_circ</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">*</span><span class="n">v_circ</span><span class="p">]</span>
</pre></div>
</div>
<p>Then graph <span class="math notranslate nohighlight">\(a^3\)</span> vs. <span class="math notranslate nohighlight">\(T^2\)</span> and show that this makes a line.  ü¶âShow that the slope of this line is</p>
<div class="math notranslate nohighlight">
\[\frac{GM}{4\pi^2}\]</div>
<p>It is helpful to add code to your class that stops your simulation after you return to the starting point. This can be done by either:</p>
<ul class="simple">
<li><p>checking that the distance from the starting point gets further away-&gt;closer-&gt;further away</p></li>
<li><p>monitoring the <span class="math notranslate nohighlight">\(r\)</span> of your planet</p></li>
<li><p>by checking how close the <span class="math notranslate nohighlight">\(x\)</span> location is to your initial spot</p></li>
</ul>
<p>It‚Äôll save you valuable running time if you implement this, but it is not necessary.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="background-just-information-no-work-on-this-problem">
<h2>Background (just information‚Ä¶no work on this problem)<a class="headerlink" href="#background-just-information-no-work-on-this-problem" title="Link to this heading">#</a></h2>
<p><strong>Post-Newtonian gravitational orbits</strong></p>
<p>Trajectories in <span class="math notranslate nohighlight">\(1/r^2\)</span> central force fields are conic sections: hyperbolas or parabolas for unbound objects, and ellipses for objects in bound orbits. A special property of an inverse-square force is that bound orbits close on themselves‚Äîthe orientation in space of the ellipse remains fixed. But if gravity were to deviate from a purely inverse-square force law, bound orbits would not close (unless they were perfectly circular), and could not strictly be described as ellipses.</p>
<p>One of the earliest tests of general relativity was its prediction for the rate at which Mercury‚Äôs orbit would change its orientation over time. Mercury‚Äôs distance from (the center of) the sun varies from 46,001,200 km at perihelion (the point at which Mercury is closest to the sun) to 69,816,900 km at aphelion, so it samples the strength of the sun‚Äôs gravitational pull over a significant range of distance.</p>
<p>The orbit‚Äôs long axis precesses 574.1 seconds of arc per century. <a class="reference internal" href="#fn1"><span class="xref myst"><sup>1</sup></span></a>. (There are 3,600 seconds of arc in one degree.) Most of this is due to the perturbing effects of the other planets, but there is a measurable contribution of 43 seconds of arc per century from the small differences between the (approximately correct) Newtonian and (extraordinarily accurate) Einsteinian descriptions of gravity. The force law, according to general relativity, isn‚Äôt quite an inverse square relation. <a class="reference internal" href="#fn2"><span class="xref myst"><sup>2</sup></span></a></p>
<p>The precession rate is small. During the course of one orbit of 87.969 days, the perihelion will shift by <span class="math notranslate nohighlight">\((5.022 \pm 0.005) \times 10^{-7}\)</span> radians due to general relativistic effects. This corresponds to a displacement in space of about 23 km for one orbit‚Äôs perihelion relative to the previous orbit‚Äôs, added to the much larger Newtonian perturbations from the other planets.</p>
<p>In weak gravitational fields we can accommodate the effects of general relativity as a slight modification <a class="reference internal" href="#fn3"><span class="xref myst"><sup>3</sup></span></a> to the acceleration of a mass <span class="math notranslate nohighlight">\(m\)</span> in an almost-elliptical orbit around the sun:</p>
<div class="math notranslate nohighlight">
\[ \frac{F(r)}{m} = -\frac{GM_\odot}{r^2} + -\frac{3r_s\left(v_\textrm{perihelion}r_\textrm{perihelion}\right)^2}{2r^4}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_\odot=1.98855 \times 10^{30}\)</span> kg is the mass of the sun.<a class="reference internal" href="#fn4"><span class="xref myst"><sup>4</sup></span></a>.  You may recall that the Schwarzschild radius <span class="math notranslate nohighlight">\(r_s\)</span> of an object of mass <span class="math notranslate nohighlight">\(M\)</span> is <span class="math notranslate nohighlight">\(2GM/c^2\)</span>, and that the sun‚Äôs <span class="math notranslate nohighlight">\(r_s\)</span> is 2,953.36 meters.  For Mercury <span class="math notranslate nohighlight">\(v_\textrm{perihelion}=58,980\)</span> m/s while <span class="math notranslate nohighlight">\(r_\textrm{perihelion} = 46,001,200\)</span> km.  (Note that the formula requires the perihelion radius to be expressed in meters.)<a class="reference internal" href="#fn5"><span class="xref myst"><sup>5</sup></span></a></p>
<p>Just for your information, here is a table of contributions to the Newtonian precession of Mercury‚Äôs perihelion from the other planets. The largest come from Venus (because it is so close to Mercury) and Jupiter (because it is so massive). These are taken from the work of the 19th century astronomer Urban LeVerrier.<a class="reference internal" href="#fn6"><span class="xref myst"><sup>6</sup></span></a>.  I think they‚Äôre probably reasonable approximations to the exact values.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>planet</p></th>
<th class="head"><p>arc-seconds per century</p></th>
<th class="head"><p>microradians per orbit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Venus</p></td>
<td><p>280.6</p></td>
<td><p>3.28</p></td>
</tr>
<tr class="row-odd"><td><p>Earth</p></td>
<td><p>83.6</p></td>
<td><p>0.98</p></td>
</tr>
<tr class="row-even"><td><p>Mars</p></td>
<td><p>2.6</p></td>
<td><p>0.03</p></td>
</tr>
<tr class="row-odd"><td><p>asteroids</p></td>
<td><p>not calculated <br />(perhaps ~0.13)</p></td>
<td><p>0.002</p></td>
</tr>
<tr class="row-even"><td><p>Jupiter</p></td>
<td><p>152.6</p></td>
<td><p>1.78</p></td>
</tr>
<tr class="row-odd"><td><p>Saturn</p></td>
<td><p>7.2</p></td>
<td><p>0.08</p></td>
</tr>
<tr class="row-even"><td><p>Uranus</p></td>
<td><p>0.1</p></td>
<td><p>0.001</p></td>
</tr>
<tr class="row-odd"><td><p>Neptune</p></td>
<td><p>not calculated <br />(perhaps ~0.04)</p></td>
<td><p>0.0005</p></td>
</tr>
<tr class="row-even"><td><p>Pluto</p></td>
<td><p>Pluto was discovered in 1930. <br />(should be negligible)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>526.7</p></td>
<td><p>6.15</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="exercise-3-mercury-precession">
<h2>Exercise 3: Mercury Precession<a class="headerlink" href="#exercise-3-mercury-precession" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>Our goal in this exercise is to determine how general relativity affects the precision of Mercury.  We know from Kepler‚Äôs laws that objects orbiting around a central body orbit in an ellipse.  That means the second time around their orbit they come back to the same place that they started.  If you have more then two bodies (like above) or if there are corrections to gravity from general relativity (which there are), then you aren‚Äôt going to come back exactly to the same place.  Instead the orbit precesses around.  There‚Äôs a good picture <a class="reference external" href="https://aether.lbl.gov/www/classes/p10/gr/PrecessionperihelionMercury.htm">here</a>.</p>
<p>To measure the precision you want measure the angle between two consecutive perihelions (the closest distance on ellipse of the orbit). The most sensible thing is to start at the perihelion and then measure its closest distance when it comes around again.  This is not too hard to do but a bit tricky to get correct.  Here is a good prescription:</p>
<ul class="simple">
<li><p>Start at the perihelion.</p></li>
<li><p>Perform slightly more then one orbit (say 10% more)</p></li>
<li><p>Measure the index in the array for the closest point to the Sun you get when you come back around.  To avoid measuring the fact that you are close at your ‚Äústarting‚Äù location, I recommend that you look for your closest distance that isn‚Äôt in the first quarter of the orbit.</p></li>
<li><p>Now, because you are taking discrete time steps, the closest location you find might not actually be the closest location (because maybe it got closer somewhere between the steps you took).  This will matter for this measurement.  To fix this, let‚Äôs interpolate between around this part of the orbit.</p>
<ul>
<li><p>Take the three points before and after the position you found in the orbit</p></li>
<li><p>Fit a quadratic curve around this part of the orbit: <code class="docutils literal notranslate"><span class="pre">line=np.polyfit(x,y,2)</span></code>. You can evaluate the line using <code class="docutils literal notranslate"><span class="pre">np.polyval(line,</span> <span class="pre">x_interp)</span></code></p></li>
<li><p>Find the closest location of this curve by producing a new array with 100000 points which goes from the three points before and after the position you found <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code></p></li>
<li><p>Get the angle between the lines (sun,original perihelion) and (sun, new perihelion)</p></li>
</ul>
</li>
</ul>
<p>It will probably help you if you write a function <code class="docutils literal notranslate"><span class="pre">perihelion</span></code> that takes the positions array and generates the angle of precession.</p>
<section id="a-mercury-without-general-relativity">
<h3>a.  Mercury without general relativity<a class="headerlink" href="#a-mercury-without-general-relativity" title="Link to this heading">#</a></h3>
<p>For our first step, we will compute the precession when we don‚Äôt have the relativistic term on.  If our integration was perfect, we should get zero. As we recall from earlier assignments, we know that that there is some time-step errors associated with our integration.  So instead of getting zero, we would expect to get something very close to zero.</p>
<p>You are going to base your Mercury perihelion code on your orbital code from previous units. Let‚Äôs start by setting up your code for simulating Mercury‚Äôs orbit:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_\textrm{min}=4.60012 \times 10^{10}\)</span> m - i.e. <code class="docutils literal notranslate"><span class="pre">initial_pos=np.array([0.0,4.60012e10])</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(v=5.898 \times 10^{4}\)</span> m/s</p></li>
<li><p><span class="math notranslate nohighlight">\(T=60 \times 60 \times 24 \times 88 \times 1.1\)</span> sec  (1.1 Mercury Years)</p></li>
<li><p><span class="math notranslate nohighlight">\(dt=60\)</span>  sec.</p></li>
</ul>
<p>Plot the orbit of the eccentric Mercury and  report the closest and furthest distance your simulation gets from the sun.
You should find a minimum distance of 46001200000.517811935.</p>
<p>Then find the closest distance and nearby 5 points the second time around the orbit <em>not</em> where you started.  You should get</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>                    <span class="n">y</span>                    <span class="n">r</span> 
<span class="o">-</span><span class="mf">10087525.09595282</span> <span class="mf">46001199082.443085</span> <span class="mf">46001200188.48122315</span>
<span class="o">-</span><span class="mf">6548725.141774705</span> <span class="mf">46001199613.28912</span> <span class="mf">46001200079.42697562</span>
<span class="o">-</span><span class="mf">3009925.1554468116</span> <span class="mf">46001199918.30062</span> <span class="mf">46001200016.772504188</span>
<span class="mf">528874.8456577625</span> <span class="mf">46001199997.47758</span> <span class="mf">46001200000.517809045</span>
<span class="mf">4067674.8441659217</span> <span class="mf">46001199850.81999</span> <span class="mf">46001200030.66289309</span>
<span class="mf">7606474.822704569</span> <span class="mf">46001199478.327866</span> <span class="mf">46001200107.20775908</span>
</pre></div>
</div>
<p>If you‚Äôre not getting this, then you should check again.</p>
<p>Make a separate plot of just these 6 points.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="b-interpolating-to-find-the-precession">
<h3>b. Interpolating to find the  precession<a class="headerlink" href="#b-interpolating-to-find-the-precession" title="Link to this heading">#</a></h3>
<p>Now we need to take our data of those 6 points above and interpolate between them.  (Use your actual orbital data not the copied numbers above - you need higher precision then is being printed out.)</p>
<p>Put the 6 points in an array <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> respectively.  You may have to do something like  <code class="docutils literal notranslate"><span class="pre">x=np.float64(pos[closest_loc-3:closest_loc+3,0])</span></code> to get it to be low enough precision for the polyfit (next step) to work.</p>
<p>Now interpolate between them using <code class="docutils literal notranslate"><span class="pre">line=np.polyfit(x,y,2)</span></code>.</p>
<p>Now make a new <code class="docutils literal notranslate"><span class="pre">xs</span></code> array which has  100000 points between x[0] and x[-1].  This will be a very fine grid.  Then make a <code class="docutils literal notranslate"><span class="pre">ys</span></code> array that uses the quadratic fit in <code class="docutils literal notranslate"><span class="pre">line</span></code> and the <code class="docutils literal notranslate"><span class="pre">xs</span></code> array to give you the interpolated values.</p>
<p>Plot both the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> array as points as well as the <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> array as lines.  This line should interpolate nicely through your points.</p>
<p>Finally, using your new <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> array you should get that the nearest distance is something very close to <code class="docutils literal notranslate"><span class="pre">46001199999.997996964</span></code>.</p>
<p>Now you should be able to get the actual coordinate of the closest point (the second time around).  Using this you can get the precession angle.
I get that it is -0.017013797776581767923 microradians (but because this is very sensitive to precision, anything less then 0.03 microradians is fine.)</p>
<p>We will consider anything less then 0.03 microradians in magnitude essentially zero.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-mercury-with-general-relativity">
<h3>c.  Mercury with general relativity<a class="headerlink" href="#c-mercury-with-general-relativity" title="Link to this heading">#</a></h3>
<p>Now turn on the effects of general relativity (by modifying your force) and do the same computation.</p>
<p>The post-Newtonian modification to the gravitational acceleration experienced by Mercury adds an extra term after the inverse-square Newtonian term:</p>
<div class="math notranslate nohighlight">
\[ \frac{F(r)}{m} = -\frac{GM_\odot}{r^2} - \frac{3r_s\left(v_\textrm{perihelion}r_\textrm{perihelion}\right)^2}{2r^4}\]</div>
<p>The Schwarzschild radius of the sun is <span class="math notranslate nohighlight">\(r_S = 2,953.36\)</span> meters. Mercury‚Äôs speed at perihelion is
<span class="math notranslate nohighlight">\(v_\textrm{perihelion} = 58,980\)</span> m/s while its <span class="math notranslate nohighlight">\(r_\textrm{perihelion} = 4.60012e10\)</span> m.</p>
<p>ü¶âPlease add the post-Newtonian term to the acceleration of gravity and repeat parts (a) and (b)</p>
<p>I now get (in 11 seconds)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">minimum</span> <span class="n">location</span> <span class="n">before</span> <span class="n">interpolation</span> <span class="ow">is</span>  <span class="mf">46001200000.654238053</span>
<span class="n">The</span> <span class="n">minimum</span> <span class="n">location</span> <span class="n">after</span> <span class="n">interpolation</span> <span class="ow">is</span>  <span class="mf">46001199999.99801791</span>
<span class="n">The</span> <span class="n">maximum</span> <span class="n">location</span> <span class="ow">is</span>  <span class="mf">46923484445.272278626</span>
<span class="n">The</span> <span class="n">precession</span> <span class="n">angle</span> <span class="n">I</span> <span class="n">get</span> <span class="ow">is</span>  <span class="mf">0.4887683792163817</span>
</pre></div>
</div>
<p>Note that the actual value is 0.5022 microradians per orbit. That‚Äôs pretty good!</p>
<p><strong>HINT:</strong> For this assignment you need to get points around the closest distance (the second time around the orbit, <em>not</em> where you start).  You should get some of the close points as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>                   <span class="n">y</span>                   <span class="n">r</span>
<span class="o">-</span><span class="mf">9998967.016889445</span> <span class="mf">46001199099.338745</span> <span class="mf">46001200186.04237594</span>
<span class="o">-</span><span class="mf">6460167.061694921</span> <span class="mf">46001199624.2306</span> <span class="mf">46001200077.84657632</span>
<span class="o">-</span><span class="mf">2921367.0747853755</span> <span class="mf">46001199923.28789</span> <span class="mf">46001200016.05052716</span>
<span class="mf">617432.9264660933</span> <span class="mf">46001199996.51061</span> <span class="mf">46001200000.654237192</span>
<span class="mf">4156232.9246863867</span> <span class="mf">46001199843.898766</span> <span class="mf">46001200031.65769507</span>
<span class="mf">7695032.902502406</span> <span class="mf">46001199465.452354</span> <span class="mf">46001200109.060909245</span>
</pre></div>
</div>
<p>If you‚Äôre not getting this, then you should check again.  Then you need to interpolate through this data (<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">line=np.polyfit(x,y,2)</span></code>).  Finally, you should get that the nearest distance is (after interpolation) something very close to <code class="docutils literal notranslate"><span class="pre">46001199999.99801791</span></code>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
</section>
<section id="exercise-4-transfer-orbits-extra-credit-5-points">
<h2>Exercise 4. Transfer Orbits (Extra Credit: 5 points)<a class="headerlink" href="#exercise-4-transfer-orbits-extra-credit-5-points" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>If you are trying to get spacecraft around the solar system, an important thing to be able to do is to get a spacecraft from one point to another point in a time <span class="math notranslate nohighlight">\(T\)</span>.  To do this, the spacecraft will need to choose a particular velocity (speed and direction) to be heading in. Write a function <code class="docutils literal notranslate"><span class="pre">transfer(pos1,pos2,T)</span></code> which determines the velocity to get the spacecraft from pos1 to pos2 in time T.</p>
<hr class="docutils" />
<p>¬© Copyright 2020</p>
<ul class="simple">
<li><p>Ex 1: George Gollin (original); Bryan Clark (modifications)</p></li>
<li><p>Ex 2: Bryan Clark (original)</p></li>
<li><p>Ex 3: George Gollin (original); Bryan Clark (modifications)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the filename</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">requests</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">socket</span><span class="w"> </span><span class="kn">import</span> <span class="n">gethostname</span><span class="p">,</span> <span class="n">gethostbyname</span>
<span class="n">ip</span> <span class="o">=</span> <span class="n">gethostbyname</span><span class="p">(</span><span class="n">gethostname</span><span class="p">())</span> 
<span class="n">filename</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;http://</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:9000/api/sessions&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%20&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CHECK FILENAME&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="c1"># Now we mount the file on Drive and convert it to HTML</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;/content/drive/MyDrive/Colab Notebooks/&quot;</span> <span class="o">+</span> <span class="n">filename</span>
<span class="o">!</span>cp<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$filepath</span><span class="s2">&quot;</span><span class="w"> </span>./
<span class="o">!</span>jupyter<span class="w"> </span>nbconvert<span class="w"> </span>--to<span class="w"> </span>HTML<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$filename</span><span class="s2">&quot;</span>
<span class="n">files</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ipynb&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ConnectionRefusedError</span><span class="g g-Whitespace">                    </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connection.py:204,</span> in <span class="ni">HTTPConnection._new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">204</span>     <span class="n">sock</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dns_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>         <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>         <span class="n">source_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source_address</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span>         <span class="n">socket_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span> <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/util/connection.py:85,</span> in <span class="ni">create_connection</span><span class="nt">(address, timeout, source_address, socket_options)</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">85</span>     <span class="k">raise</span> <span class="n">err</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span>     <span class="c1"># Break explicitly a reference cycle</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/util/connection.py:73,</span> in <span class="ni">create_connection</span><span class="nt">(address, timeout, source_address, socket_options)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>     <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">source_address</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">73</span> <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="c1"># Break explicitly a reference cycle</span>

<span class="ne">ConnectionRefusedError</span>: [Errno 111] Connection refused

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">NewConnectionError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connectionpool.py:787,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span> <span class="c1"># Make the request on the HTTPConnection object</span>
<span class="ne">--&gt; </span><span class="mi">787</span> <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>     <span class="n">conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">789</span>     <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>     <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>     <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">response_conn</span><span class="o">=</span><span class="n">response_conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>     <span class="n">preload_content</span><span class="o">=</span><span class="n">preload_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">decode_content</span><span class="o">=</span><span class="n">decode_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>     <span class="o">**</span><span class="n">response_kw</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span> <span class="c1"># Everything went great!</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connectionpool.py:493,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">492</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">493</span>     <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">494</span>         <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">495</span>         <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span>         <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">497</span>         <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">498</span>         <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">499</span>         <span class="n">preload_content</span><span class="o">=</span><span class="n">preload_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span>         <span class="n">decode_content</span><span class="o">=</span><span class="n">decode_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>         <span class="n">enforce_content_length</span><span class="o">=</span><span class="n">enforce_content_length</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span> <span class="c1"># We are swallowing BrokenPipeError (errno.EPIPE) since the server is</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span> <span class="c1"># legitimately able to close the connection after sending a valid response.</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span> <span class="c1"># With this behaviour, the received response is still readable.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connection.py:500,</span> in <span class="ni">HTTPConnection.request</span><span class="nt">(self, method, url, body, headers, chunked, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">499</span>     <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">500</span> <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span> <span class="c1"># If we&#39;re given a body we start sending that in chunks.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/http/client.py:1353,</span> in <span class="ni">HTTPConnection.endheaders</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1352</span>     <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1353</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/http/client.py:1113,</span> in <span class="ni">HTTPConnection._send_output</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1112</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
<span class="ne">-&gt; </span><span class="mi">1113</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1115</span> <span class="k">if</span> <span class="n">message_body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1116</span> 
<span class="g g-Whitespace">   </span><span class="mi">1117</span>     <span class="c1"># create a consistent interface to message_body</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/http/client.py:1057,</span> in <span class="ni">HTTPConnection.send</span><span class="nt">(self, data)</span>
<span class="g g-Whitespace">   </span><span class="mi">1056</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1057</span>     <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1058</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connection.py:331,</span> in <span class="ni">HTTPConnection.connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span> <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">331</span>     <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_conn</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>         <span class="c1"># If we&#39;re tunneling it means we&#39;re connected to our proxy.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connection.py:219,</span> in <span class="ni">HTTPConnection._new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">219</span>     <span class="k">raise</span> <span class="n">NewConnectionError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>         <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to establish a new connection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>     <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span> <span class="n">sys</span><span class="o">.</span><span class="n">audit</span><span class="p">(</span><span class="s2">&quot;http.client.connect&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>

<span class="ne">NewConnectionError</span>: HTTPConnection(host=&#39;10.1.0.195&#39;, port=9000): Failed to establish a new connection: [Errno 111] Connection refused

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">MaxRetryError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/adapters.py:644,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">644</span>     <span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>         <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>         <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">647</span>         <span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">648</span>         <span class="n">headers</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">649</span>         <span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">650</span>         <span class="n">assert_same_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">651</span>         <span class="n">preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">652</span>         <span class="n">decode_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span>         <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">654</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">655</span>         <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">658</span> <span class="k">except</span> <span class="p">(</span><span class="n">ProtocolError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/connectionpool.py:841,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">839</span>     <span class="n">new_e</span> <span class="o">=</span> <span class="n">ProtocolError</span><span class="p">(</span><span class="s2">&quot;Connection aborted.&quot;</span><span class="p">,</span> <span class="n">new_e</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">841</span> <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span>     <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">new_e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">843</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">844</span> <span class="n">retries</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/urllib3/util/retry.py:535,</span> in <span class="ni">Retry.increment</span><span class="nt">(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="n">reason</span> <span class="o">=</span> <span class="n">error</span> <span class="ow">or</span> <span class="n">ResponseError</span><span class="p">(</span><span class="n">cause</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">535</span>     <span class="k">raise</span> <span class="n">MaxRetryError</span><span class="p">(</span><span class="n">_pool</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">reason</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">537</span> <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Incremented Retry for (url=&#39;</span><span class="si">%s</span><span class="s2">&#39;): </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">new_retry</span><span class="p">)</span>

<span class="ne">MaxRetryError</span>: HTTPConnectionPool(host=&#39;10.1.0.195&#39;, port=9000): Max retries exceeded with url: /api/sessions (Caused by NewConnectionError(&quot;HTTPConnection(host=&#39;10.1.0.195&#39;, port=9000): Failed to establish a new connection: [Errno 111] Connection refused&quot;))

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ConnectionError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">from</span><span class="w"> </span><span class="nn">socket</span><span class="w"> </span><span class="kn">import</span> <span class="n">gethostname</span><span class="p">,</span> <span class="n">gethostbyname</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">ip</span> <span class="o">=</span> <span class="n">gethostbyname</span><span class="p">(</span><span class="n">gethostname</span><span class="p">())</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;http://</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:9000/api/sessions&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%20&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CHECK FILENAME&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/api.py:73,</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sends a GET request.</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">65</span><span class="sd">     :param url: URL for the new :class:`Request` object.</span>
<span class="sd">   (...)     70     :rtype: requests.Response</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">73</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/api.py:59,</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="c1"># By using the &#39;with&#39; statement we are sure the session is closed, thus we</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="c1"># avoid leaving sockets open which can trigger a ResourceWarning in some</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">59</span>     <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/sessions.py:589,</span> in <span class="ni">Session.request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span> <span class="n">send_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>     <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>     <span class="s2">&quot;allow_redirects&quot;</span><span class="p">:</span> <span class="n">allow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span> <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">589</span> <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span> <span class="k">return</span> <span class="n">resp</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/sessions.py:703,</span> in <span class="ni">Session.send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span> <span class="n">start</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">703</span> <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="c1"># Total elapsed time of the request (approximately)</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/adapters.py:677,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">_SSLError</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span>         <span class="c1"># This branch is for urllib3 v1.22 and later.</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span>         <span class="k">raise</span> <span class="n">SSLError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">677</span>     <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">679</span> <span class="k">except</span> <span class="n">ClosedPoolError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span>     <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

<span class="ne">ConnectionError</span>: HTTPConnectionPool(host=&#39;10.1.0.195&#39;, port=9000): Max retries exceeded with url: /api/sessions (Caused by NewConnectionError(&quot;HTTPConnection(host=&#39;10.1.0.195&#39;, port=9000): Failed to establish a new connection: [Errno 111] Connection refused&quot;))
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Dynamics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dynamics</p>
      </div>
    </a>
    <a class="right-next"
       href="Exoplanets_short.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exoplanets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warmups">Warmups</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#planetary-parameters">Planetary Parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-orbital-dynamics">Exercise 1. Orbital Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-plot-a-model-of-the-solar-system">a. Plot a model of the solar system.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-modify-your-code-to-include-the-force-of-gravity">b. Modify your code to include the force of gravity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-earth-orbiting-the-sun">c.  Earth Orbiting the Sun</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-animation">d. Animation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-geosyncronous-orbit-extra-credit-5-points">e. Geosyncronous Orbit (Extra Credit: 5 Points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-kepler-s-laws">Exercise 2. Kepler‚Äôs Laws</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-law-2">a. Law 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-law-1-extra-credit-10-points">b. Law 1 (Extra Credit: 10 points)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-law-3-extra-credit-10-points">c. Law 3: (Extra Credit: 10 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-just-information-no-work-on-this-problem">Background (just information‚Ä¶no work on this problem)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-mercury-precession">Exercise 3: Mercury Precession</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-mercury-without-general-relativity">a.  Mercury without general relativity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-interpolating-to-find-the-precession">b. Interpolating to find the  precession</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-mercury-with-general-relativity">c.  Mercury with general relativity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-transfer-orbits-extra-credit-5-points">Exercise 4. Transfer Orbits (Extra Credit: 5 points)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark; George Gollin; Ryan Levy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>