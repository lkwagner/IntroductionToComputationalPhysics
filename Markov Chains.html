
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Markov Chains &#8212; Physics 246</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Markov Chains';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Predator-Prey" href="Predator-Prey.html" />
    <link rel="prev" title="Random Walks" href="Random%20Walks.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/FD.png" class="logo__image only-light" alt="Physics 246 - Home"/>
    <img src="_static/FD.png" class="logo__image only-dark pst-js-only" alt="Physics 246 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An Introduction to Modern Computational Physics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="N_Ways_of_Measuring_PI.html">N ways to measure <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OrbitalDynamics.html">Orbital Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exoplanets.html">Exoplanets</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaos.html">Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticlePhysics.html">Particle Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearningGalaxies.html">Classifying Galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Random%20Walks.html">Random Walks</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="Predator-Prey.html">Predator-Prey</a></li>
<li class="toctree-l1"><a class="reference internal" href="Climate.html">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="FluidDynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC1.html">Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2.html">Building a Physical Qubit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/bkclark/IntroductionToComputationalPhysics/blob/main/IntroductionToComputationalPhysics/Markov Chains.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Markov Chains.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Markov Chains</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-weather-markov-chains">Exercise 1: Weather Markov Chains</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">0. Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-weather-probabilities">a. Weather Probabilities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#information-about-markov-chain-monte-carlo">Information about Markov Chain Monte Carlo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metropolis-algorithm">Metropolis Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-physics-and-the-boltzmann-distribution">Thermal physics and the Boltzmann distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-the-thermodynamics-of-a-paramagnetic-material">Exercise 2: The thermodynamics of a paramagnetic material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-thermodynamics-of-rubber-bands">Exercise 3: Thermodynamics of rubber bands</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rubber-bands-at-infinite-temperature">a. Rubber bands at infinite temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rubber-bands-at-finite-temperature">b. Rubber bands at finite temperature</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="markov-chains">
<h1>Markov Chains<a class="headerlink" href="#markov-chains" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;random&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="k">return</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2025, 1, 29, 16, 9, 10, 404693)
</pre></div>
</div>
</div>
</div>
<section id="exercise-1-weather-markov-chains">
<h2>Exercise 1: Weather Markov Chains<a class="headerlink" href="#exercise-1-weather-markov-chains" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<section id="background">
<h3>0. Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h3>
<p>In science and engineering, random (or stochastic) processes are commonplace. Electron velocities in a wire, stock prices in the stock market, and traffic congestion on a highway are all examples of time-dependent random processes. To understand such systems, scientists and engineers make use of the Markov chain, a stochastic process model developed by the Russian mathematician Andrey Markov in the 1900s.</p>
<p>A Markov chain is often described as a “memory-less” random process. This means that the next state of the system only depends on the current state and not on any previous states. To see how a Markov chain works, we will study a simple example with a helpful visualization.</p>
<p>Suppose we make a simplistic model of summer weather in Champaign, Illinois using a Markov chain. We say that there are only three states for a day’s weather: sunny, cloudy, and rainy. The Markov chain is specified by the probabilities of transitioning from state 𝐴 to state 𝐵, i.e., from today’s weather 𝐴 to tomorrow’s weather 𝐵, which we call <span class="math notranslate nohighlight">\(P(A \rightarrow B)\)</span>  For example, maybe we think that 50% of the time a cloudy day leads to a rainy day, so that <span class="math notranslate nohighlight">\(P(\textrm{cloudy } \rightarrow \textrm{ rainy})=0.5\)</span>  And maybe we believe that 75% of the time a sunny day is followed by another sunny day, so that <span class="math notranslate nohighlight">\(𝑃(\textrm{ sunny } \rightarrow \textrm{sunny}) =0.75\)</span>  Once we have defined all these transition probabilities we have made a Markov chain such as the one below.</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_weather.png" width=400 alt="Answer (start)"></img><br></div>
<p>Now that we have our Markov chain, what can we do with it? We can sample states from it! Here’s how that works:</p>
<ol class="arabic simple">
<li><p>Start at a state <span class="math notranslate nohighlight">\(𝑥_t\)</span>. For example, a sunny day.</p></li>
<li><p>Randomly pick a state <span class="math notranslate nohighlight">\(x_{t+1}\)</span> to move to according to the transition probabilities <span class="math notranslate nohighlight">\(P(x_t \rightarrow x_{t+1})\)</span>.
For example, draw a uniform random number <span class="math notranslate nohighlight">\(r\)</span> between 0 and 1. If  <span class="math notranslate nohighlight">\(P(\textrm{ sunny } \rightarrow \textrm{sunny}) = 0.90\)</span>, <span class="math notranslate nohighlight">\(P(\textrm{ sunny } \rightarrow \textrm{cloudy})  = 0.075\)</span>, <span class="math notranslate nohighlight">\(P(\textrm{ sunny } \rightarrow \textrm{rainy})   = 0.025\)</span>, then we say that a random number from 0 to 0.90 goes to a sunny day, one from 0.90 to 0.975 to a cloudy day, and 0.975 to 1.0 to a rainy day. If <span class="math notranslate nohighlight">\(r = 0.9234352\)</span>, then the next day is cloudy.</p></li>
<li><p>Increment <span class="math notranslate nohighlight">\(t\)</span> and repeat.</p></li>
</ol>
<p>A single random sampling might look something like
𝑠𝑢𝑛𝑛𝑦 → 𝑠𝑢𝑛𝑛𝑦 → 𝑠𝑢𝑛𝑛𝑦 → 𝑐𝑙𝑜𝑢𝑑𝑦 → 𝑠𝑢𝑛𝑛𝑦 → 𝑟𝑎𝑖𝑛𝑦 → 𝑐𝑙𝑜𝑢𝑑𝑦 → 𝑟𝑎𝑖𝑛𝑦 → ⋯</p>
<p>Once you are able to sample from this model, you can ask some interesting questions. For example, you could ask: what is the unconditional probability of a rainy day or what is the probability of getting five sunny days in a row? We will look at this in the next exercise.</p>
<p>By now you might be able to see how the random walks we studied earlier were examples of Markov chains. Each step of the random walk only depended on the current position and randomly took the pollen grain to a new position. In that case, the states were represented by continuous variables (position) while in the weather example the states are discrete (sunny, cloudy, or rainy). Nonetheless, the idea is exactly the same.</p>
</section>
<section id="a-weather-probabilities">
<h3>a. Weather Probabilities<a class="headerlink" href="#a-weather-probabilities" title="Link to this heading">#</a></h3>
<p>🦉Implement the Markov chain described in the previous section. The transition probabilities we will use are given in the following table:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><em>state</em></p></th>
<th class="head"><p>sunny</p></th>
<th class="head"><p>cloudy</p></th>
<th class="head"><p>rainy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>sunny</em></p></td>
<td><p>0.9</p></td>
<td><p>0.075</p></td>
<td><p>0.025</p></td>
</tr>
<tr class="row-odd"><td><p><em>cloudy</em></p></td>
<td><p>0.15</p></td>
<td><p>0.8</p></td>
<td><p>0.05</p></td>
</tr>
<tr class="row-even"><td><p><em>rainy</em></p></td>
<td><p>0.25</p></td>
<td><p>0.25</p></td>
<td><p>0.5</p></td>
</tr>
</tbody>
</table>
</div>
<p>In particular, run 10000 steps of Markov chain sampling and keep a running (or cumulative) average of how many times you have seen each state. One way to do this is by having three length 10000 arrays <code class="docutils literal notranslate"><span class="pre">sunnyCounts</span></code>, <code class="docutils literal notranslate"><span class="pre">cloudyCounts</span></code>, <code class="docutils literal notranslate"><span class="pre">rainyCounts</span></code> that you fill with zeros and ones at each step, depending on which state you are at. The cumulative average of a sunny day, for example, will then be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sunnyCumAvg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sunnyCounts</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_so_far</span>
</pre></div>
</div>
<p>After enough steps, these running averages will approximate the unconditional probability distributions P(sunny), P(cloudy), P(rainy) Your result should look something like the following figure</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_probability.png" width=500  alt="Answer (start)"></img><br></div><p>Notice that the Markov chain quickly settles down to equilibrium and the averages converge to constant values. Each Markov chain has an equilibration time. One should always wait until after the equilibration time before collecting statistics from a Markov chain. We have not measured the equilibration time, but for such a simple Markov chain with very few possible states, the equilibration time is very short. There are other time scales, such as the autocorrelation time and the mixing time, that are important to consider when using Markov chains, but I will not discuss them here.</p>
<p>When run for 10000 steps, my Markov chain obtains the following estimates for the unconditional probabilities P(sunny)=0.625, P(cloudy) = 0.3125, P(rainy) =0.0625.  Make sure you obtain similar values.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div>
</section>
</section>
<hr class="docutils" />
<section id="information-about-markov-chain-monte-carlo">
<h2>Information about Markov Chain Monte Carlo<a class="headerlink" href="#information-about-markov-chain-monte-carlo" title="Link to this heading">#</a></h2>
<p>Here we will discuss how to use Markov Chain Monte Carlo (MCMC) to compute expectation values.  In statistics, we study the properties of random variables <span class="math notranslate nohighlight">\(x\)</span> and their probability distributions <span class="math notranslate nohighlight">\(P(x)\)</span>.  We often care about computing expectation values of functions of the random variable such as</p>
<div class="math notranslate nohighlight">
\[\langle f(x) \rangle = \sum_x f(x) P(x)\]</div>
<p>In general, the probability distribution <span class="math notranslate nohighlight">\(P(x)\)</span> can be very complicated and difficult to sample efficiently. In this case, we can use Markov chains to represent the probability distribution <span class="math notranslate nohighlight">\(P(x)\)</span>.   It is possible to pick the transition probabilities of the Markov chain so that the chain’s equilibrium probability distribution is the desired probability distribution <span class="math notranslate nohighlight">\(P(x)\)</span>. Once we have a correctly defined Markov chain, we can sample it to obtain a set of sampled states <span class="math notranslate nohighlight">\(x_1,x_2,...,x_T\)</span>.  These sampled states can be used to estimate expectation values in the following way
$<span class="math notranslate nohighlight">\( \langle f(x) \rangle \approx \frac{1}{T_{max}} \sum_{t=1}^{T_{max}} f(x_t)\)</span>$</p>
<p>This should look familiar. This is secretly what we were doing when we were computing the RMS displacement of random walks previously.  However, you should be clear on the distinction between Monte Carlo and Markov chains. Monte Carlo methods are ways to evaluate integrals using random numbers. Markov chains are used to sample complicated probability distributions. When Monte Carlo is used to integrate a probability distribution specified by a Markov chain, then it is called Markov Chain Monte Carlo.</p>
<section id="metropolis-algorithm">
<h3>Metropolis Algorithm<a class="headerlink" href="#metropolis-algorithm" title="Link to this heading">#</a></h3>
<p>A very common form of Markov Chain Monte Carlo is the Metropolis algorithm. This was the first MCMC algorithm developed. It was proposed in 1953 by Edward Teller, Nicholas Metropolis, and others at Los Alamos National Laboratory in New Mexico during the early days of scientific computing. Teller and his physics colleagues were interested in using MCMC to calculate the thermodynamic properties of a weakly interacting classical gas, which was very difficult to calculate analytically. Impressively, more than half a century after its introduction, Metropolis MCMC is still in wide use today in many areas of science, engineering, and statistics.</p>
<p>The Metropolis algorithm samples a Markov chain by proposing moves between states, which are then either accepted or rejected according to a specific criterion. These proposed moves are chosen so that the Markov chain’s transition probabilities give the correct equilibrium distribution4. In general, Metropolis Markov chain sampling of a probability distribution <span class="math notranslate nohighlight">\(P(S)\)</span> works as follows:</p>
<ol class="arabic simple">
<li><p>Start at a state <span class="math notranslate nohighlight">\(𝑆_t\)</span>.</p></li>
<li><p>Propose a move to a new state <span class="math notranslate nohighlight">\(S'\)</span> based on the current state <span class="math notranslate nohighlight">\(S_t\)</span>.</p></li>
<li><p>Choose a uniform random number <span class="math notranslate nohighlight">\(r\)</span> between 0 and 1.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r&lt;P(S')/P(S_t)\)</span> then accept the proposed move and transition to state <span class="math notranslate nohighlight">\(S'\)</span> so that <span class="math notranslate nohighlight">\(S_{t+1}=S'\)</span>   Otherwise, reject the move and stay at state <span class="math notranslate nohighlight">\(S_t\)</span> so that <span class="math notranslate nohighlight">\(S_{t+1}=S_t\)</span>.</p></li>
<li><p>Increment <span class="math notranslate nohighlight">\(t\)</span> and repeat.</p></li>
</ol>
<p>This Markov chain’s samples <span class="math notranslate nohighlight">\(S_1,...S_{T_{max}}\)</span> are then used to estimate expectation values <span class="math notranslate nohighlight">\(\langle f(S) \rangle\)</span> in the way  discussed in the previous section. We will use this general Metropolis MCMC framework to sample the Boltzmann distribution, an important probability distribution in thermal physics.</p>
</section>
<section id="thermal-physics-and-the-boltzmann-distribution">
<h3>Thermal physics and the Boltzmann distribution<a class="headerlink" href="#thermal-physics-and-the-boltzmann-distribution" title="Link to this heading">#</a></h3>
<p>In some ways, the type of physics that we encounter most often in our everyday lives is thermal physics. We are perpetually surrounded by a heat bath of <span class="math notranslate nohighlight">\(\approx 10^{27}\)</span> particles whizzing around us. The black-body radiation we receive from the sun is in thermal equilibrium with the Earth’s surface. The phases of matter we see and interact with every day, such as liquid water, gaseous oxygen, or solid iron, are all described by the physics of thermodynamics and statistical mechanics.</p>
<p>Physical systems that are in thermal equilibrium with a heat bath obey the laws of statistical mechanics. Heat baths are large physical systems that are assumed to be at a constant temperature <span class="math notranslate nohighlight">\(T\)</span>. A small system put in contact with a heat bath is able to exchange energy with the heat bath so that it also stays at the same temperature.</p>
<!-- ![image.png](attachment:image.png) -->
<div><img src="https://clark.physics.illinois.edu/246img/MC_heatbath.png" width=400  alt="Answer (start)"></img><br></div><p>Statistical mechanics tells us that the probability distribution of the small system’s states in thermal equilibrium with the heat bath is given by the Boltzmann distribution</p>
<div class="math notranslate nohighlight">
\[P(S) = \frac{1}{Z} e^{-E(S)/k_BT}\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is a state of the system, <span class="math notranslate nohighlight">\(E(S)\)</span>  is the energy of the system in state <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(T\)</span>  is the temperature in Kelvin, <span class="math notranslate nohighlight">\(k_B=1.38 \times 10^{-23} J/K\)</span> is the  Boltzmann’s constant, and <span class="math notranslate nohighlight">\(Z\)</span> is a normalization constant.</p>
<p>The Boltzmann distribution tells us which of the small system’s states are most important in thermal equilibrium. In general, at low temperatures, the ground state configuration is most important. At high temperatures <span class="math notranslate nohighlight">\((k_B T \gg E(S))\)</span>, all states are equally important.  For intermediate temperatures, things can be quite complicated. In such situations, we can use MCMC to efficiently sample the Boltzmann distribution to understand the thermal physics of our system.</p>
<p>To gain some intuition about the Boltzmann distribution, let’s look at an example. Consider a physical system whose state energies are given by the following quadratic function:</p>
<!-- ![image.png](attachment:image.png) -->
<div><img src="https://clark.physics.illinois.edu/246img/MC_energy.png" width=400  alt="Answer (start)"></img><br></div>
<p>At different temperatures, there are different Boltzmann distributions for the states. At low, intermediate, and high temperatures, the Boltzmann distributions look like this:</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_prob.png" width=700  alt="Answer (start)"></img><br></div><p>As we just discussed, at low temperatures the system is almost always in the ground state (state 50 in this example). At high temperatures, thermal fluctuations make the system equally likely to be in any state. At intermediate temperatures, states close to the ground state are preferred but are not the only states that matter.</p>
</section>
</section>
<section id="exercise-2-the-thermodynamics-of-a-paramagnetic-material">
<h2>Exercise 2: The thermodynamics of a paramagnetic material<a class="headerlink" href="#exercise-2-the-thermodynamics-of-a-paramagnetic-material" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>To see what we can do with MCMC and the Boltzmann distribution, let’s consider a simple physical system: a paramagnet. The magnets that you are probably most familiar with in your day-to-day life are ferromagnets, such as iron magnets, which are always magnetized. Paramagnets, however, are only magnetized when they are in the presence of a magnetic field. When you take the field away, they lose their magnetization (unlike ferromagnets, which remain magnetized).</p>
<p>Paramagnets can be described as non-interacting magnetic dipoles in a magnetic field. Here is a cartoon of a paramagnet in one-dimension, with arrows representing dipoles aligned in different directions.</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_spins.png" width=400  alt="Answer (start)"></img><br></div><p>Since there are no interactions in this material, each dipole is independent and we can focus on the physics of a single dipole.</p>
<p>Suppose there is a magnetic field <span class="math notranslate nohighlight">\(\textbf{B}\)</span> As we know from electromagnetism, the energy of a dipole-magnetic field interaction is</p>
<div class="math notranslate nohighlight">
\[E=-\textbf{B} \cdot \textbf{m}\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{m} = \mu \textbf{S}\)</span> is the dipole moment. These are vector quantities. For simplicity, we will assume
that the magnetic field <span class="math notranslate nohighlight">\(\textbf{B}\)</span> points in the 𝑧-direction so that the equation can be written as
$<span class="math notranslate nohighlight">\(E = -\mu B \cos \theta\)</span><span class="math notranslate nohighlight">\(
where \)</span>\theta$ is the angle between the magnetic moment and the magnetic field.</p>
<p>Each orientation of the dipole is called a “state.” The possible states for the dipole are specified by the angle <span class="math notranslate nohighlight">\(0\leq \theta &lt; 2\pi\)</span>; the probability of such states in thermal equilibrium is given by the Boltzmann distribution</p>
<div class="math notranslate nohighlight">
\[P(\theta) = \frac{1}{Z} e^{-E(\theta)/k_bT} = \frac{1}{Z} e^{\mu B \cos(\theta)/k_B T} \equiv \frac{1}{Z} e^{h \cos\theta}\]</div>
<p>where <span class="math notranslate nohighlight">\(h=\mu B/k_BT\)</span> is a dimensionless quantity.</p>
<p>Now, we want to use Metropolis Markov Chain Monte Carlo to samples states from <span class="math notranslate nohighlight">\(P(\theta)\)</span> To sample states from the Markov chain, we use the steps outlined in the section on the Metropolis algorithm, but filling in the details for this specific problem:</p>
<ol class="arabic simple">
<li><p>Start at state <span class="math notranslate nohighlight">\(\theta_t\)</span></p></li>
<li><p>Propose a new state <span class="math notranslate nohighlight">\(\theta'\)</span> by doing a Gaussian random step away from <span class="math notranslate nohighlight">\(\theta_t\)</span>.</p></li>
<li><p>Choose a uniform random number <span class="math notranslate nohighlight">\(r\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r&lt;P(\theta')/P(\theta_t) = e^{h(\cos\theta'-\cos\theta_t)}\)</span>, then accept the move and set <span class="math notranslate nohighlight">\(\theta_{t+1}=\theta'\)</span>.  Otherwise, reject the move and set <span class="math notranslate nohighlight">\(\theta_{t+1}=\theta_t\)</span>.</p></li>
<li><p>Increment <span class="math notranslate nohighlight">\(t\)</span> and repeat.</p></li>
</ol>
<p>In this paramagnetic material, the magnetic dipoles want to align with the magnetic field. This means that the magnetization <span class="math notranslate nohighlight">\(M=\langle \cos \theta \rangle\)</span>, which measures the alignment of the dipole with the magnetic field, will be non-zero. We will estimate this quantity using Metropolis MCMC.</p>
<p>🦉Write code to implement the Markov chain sampling. You will compute the magnetization for a single dipole using the formula</p>
<p><span class="math notranslate nohighlight">\(M = \langle \cos \theta \rangle \approx \frac{1}{T_{max}} \sum_{t=1}^{T_{max}} \cos \theta_t\)</span></p>
<p>for ten evenly-spaced values of <span class="math notranslate nohighlight">\(h\)</span> (<span class="math notranslate nohighlight">\(h=\mu B/k_B T\)</span>) from <span class="math notranslate nohighlight">\(h=-5\)</span> to <span class="math notranslate nohighlight">\(h=5\)</span>. Use a step size of 0.75 for the Gaussian random step for picking <span class="math notranslate nohighlight">\(\theta'\)</span>, for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaprime</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
</pre></div>
</div>
<p>and run the Markov chain for <span class="math notranslate nohighlight">\(T_{max}=2000\)</span> steps.  Plot <span class="math notranslate nohighlight">\(M\)</span> versus <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>For this problem, there is an exact analytic solution, given by the formula
$<span class="math notranslate nohighlight">\(M(h) = I_1(h)/I_0(h)\)</span><span class="math notranslate nohighlight">\(
where \)</span>I_\nu(z)<span class="math notranslate nohighlight">\(  is a modified Bessel function of the second kind of order \)</span>\nu$.</p>
<p><strong>Plotting</strong><br />
🦉Plot your MCMC calculation results and the exact answer given by the above formula on the same plot. You can use the <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> module to compute the Bessel functions. For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sps</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">sps</span><span class="o">.</span><span class="n">iv</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
<p>prints the value <span class="math notranslate nohighlight">\(I_3(0.5)\)</span>.</p>
<p>You should obtain a plot that looks like this:</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_mag.png" width=400  alt="Answer (start)"></img><br></div><p>(You don’t need to compute the error bars for your MCMC data points. I included them to illustrate how accurate the results are.)</p>
<p>Note how the magnetization changes with  <span class="math notranslate nohighlight">\(h\)</span>. For small <span class="math notranslate nohighlight">\(|h|\)</span> (high temperature or low magnetic field), the spins fluctuate wildly and so don’t align with the magnetic field, which causes there to be no magnetization. For large <span class="math notranslate nohighlight">\(|h|\)</span> (low temperature or high magnetic field), the spins are mostly aligned with the magnetic field and <span class="math notranslate nohighlight">\(|M|\)</span> is close to one.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div>
</section>
<section id="exercise-3-thermodynamics-of-rubber-bands">
<h2>Exercise 3: Thermodynamics of rubber bands<a class="headerlink" href="#exercise-3-thermodynamics-of-rubber-bands" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>We will use Metropolis MCMC to investigate a simple model for rubber bands.</p>
<p>Consider a rubber band cut into a single strip. This strip we model as a one-dimensional chain of <span class="math notranslate nohighlight">\(N\)</span> polymers.  These polymers we approximate as being oval in shape and linked together in a line. Each identical polymer has a length <span class="math notranslate nohighlight">\(a\)</span> and a much smaller width <span class="math notranslate nohighlight">\(b\)</span> so that <span class="math notranslate nohighlight">\(b \ll a\)</span>.   Each polymer can be in one of two states: <em>flat</em> (lying parallel to the chain) or <em>bent</em> (lying perpendicular to the chain).</p>
<p>An example of a possible configuration of an <span class="math notranslate nohighlight">\(N=7\)</span> polymer chain with four flat and three bent polymers is shown below</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_rubberBand1.png" width=300  alt="Answer (start)"></img><br></div><p>The length of this particular configuration, when measured from head to tail, is about <span class="math notranslate nohighlight">\(Ma=4a\)</span>, ignoring the widths of the bent polymers, which are negligible. Note that even though this chain includes bent polymers that point up and down, we won’t consider polymers bent in different directions as being in different states.</p>
<p>The states of the rubber band, unlike the states of the paramagnet in the previous exercise, are discrete and can be labeled with integers. For example, the following three configurations of 7- polymer chains</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_rubberBand2.png" width=200  alt="Answer (start)"></img><br></div><p>can be labeled with arrays of binary values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configuration1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">configuration2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">configuration3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Here we chose to have the number one represent a flat polymer and the number zero a bent one.</p>
<p>Now, let’s suppose that there is an energy difference <span class="math notranslate nohighlight">\(\epsilon\)</span> between a polymer it its flat and bent states, so that the total energy of a configuration <span class="math notranslate nohighlight">\(S\)</span> o a rubber band of length <span class="math notranslate nohighlight">\(M(S)a\)</span> is
$<span class="math notranslate nohighlight">\(E(S) = \epsilon M(S).\)</span>$</p>
<p>It is  straightforward to calculate the length and energy of a configuration of the rubber band. For the first configuration above, we could do this by summing the number of ones in the binary vector:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">configuration1</span><span class="p">)</span> <span class="c1"># Will be 3 </span>
<span class="n">length1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">M1</span>
<span class="n">energy1</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">M1</span>
</pre></div>
</div>
<section id="a-rubber-bands-at-infinite-temperature">
<h3>a. Rubber bands at infinite temperature<a class="headerlink" href="#a-rubber-bands-at-infinite-temperature" title="Link to this heading">#</a></h3>
<p>🦉Write code to calculate the average length of a rubber band of <span class="math notranslate nohighlight">\(N=100\)</span> polymers at <em>infinite temperature</em> <span class="math notranslate nohighlight">\(T=\infty\)</span>.  While this might sound mysterious and difficult, it is actually very simple.  At infinite temperature (or, if you prefer, at very high temperature), each polymer configuration is equally likely. We saw this in our discussion of the Boltzmann distribution. To sample this distribution, we need to pick any configuration of polymers with equal probability.</p>
<p>This is a simple probability distribution that we can sample without a Markov chain. Do this by randomly picking polymer configurations in the following way: for each polymer in the chain, flip a coin to decide whether it is flat or bent. Your code should look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">avgLength</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numSamples</span><span class="p">):</span>
    <span class="c1"># TODO: Write code here to randomly pick a configuration </span>
    <span class="c1">#...</span>
    <span class="c1"># TODO: Write code here to compute the configuration’s length </span>
    <span class="c1"># lengthConfiguration = . . .</span>
    <span class="n">avgLength</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lengthConfiguration</span><span class="p">)</span> <span class="o">/</span> <span class="n">numSamples</span>
</pre></div>
</div>
<p>🦉Compute this average for <code class="docutils literal notranslate"><span class="pre">numSamples=10000.</span></code> You should obtain that the average length is about <span class="math notranslate nohighlight">\(\langle M \rangle a = Na/2 =50a\)</span>. At infinite temperature, flat and bent polymers are equally likely so it makes sense that each polymer is on average <span class="math notranslate nohighlight">\(a/2\)</span> length.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div>
</section>
<section id="b-rubber-bands-at-finite-temperature">
<h3>b. Rubber bands at finite temperature<a class="headerlink" href="#b-rubber-bands-at-finite-temperature" title="Link to this heading">#</a></h3>
<p>In this problem, we are going to see what happens to a rubber band when we heat it up or cool it down.</p>
<p>We will be using the Metropolis algorithm to estimate the average length of the rubber band in thermal equilibrium, that is <span class="math notranslate nohighlight">\(\langle Ma \rangle\)</span>.  For this particular problem, the Metropolis Markov chain sampling looks like this:</p>
<ol class="arabic simple">
<li><p>Start at a polymer chain configuration  <span class="math notranslate nohighlight">\(S_t\)</span>.   Compute the chain length <span class="math notranslate nohighlight">\(M(S_t)\)</span> and use it to update your estimate of <span class="math notranslate nohighlight">\(\langle M \rangle\)</span>.</p></li>
<li><p>Propose a new configuration <span class="math notranslate nohighlight">\(S'\)</span>  by randomly switching a single, randomly selected polymer in <span class="math notranslate nohighlight">\(S_t\)</span>  from flat to bent, or from bent to flat.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r&lt;P(S')/P(S_t)= e^{-(E(S')- E(S_t))/k_BT}\)</span>, then accept the move and set  <span class="math notranslate nohighlight">\(S_{t+1}=S'\)</span> . Otherwise, reject the move and set <span class="math notranslate nohighlight">\(S_{t+1}=S_t\)</span>.</p></li>
<li><p>Increment <span class="math notranslate nohighlight">\(t\)</span> and repeat.</p></li>
</ol>
<p>🦉Using Metropolis MCMC as we did in the first in-class exercise, write a function that
computes the expectation value of the chain length</p>
<div class="math notranslate nohighlight">
\[\langle M \rangle = \sum_S M(S) P(S) \approx \frac{1}{T_{max}} \sum_{t=1}^{T_{max}} M(S_t)\]</div>
<p>given the value of the ratio <span class="math notranslate nohighlight">\(\epsilon/k_BT\)</span>.  Your function, for instance, can look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the average chain length using Metropolis MCMC. </span>
    <span class="k">def</span><span class="w"> </span><span class="nf">computeAvgLength</span><span class="p">(</span><span class="n">epsilonRatio</span><span class="p">):</span>
    <span class="c1"># TODO: Write your code to compute avgLength here </span>
    <span class="c1">#...</span>
    <span class="k">return</span> <span class="n">avgLength</span>
</pre></div>
</div>
<p>In your code, work with chains of <span class="math notranslate nohighlight">\(N=100\)</span> polymers  and run <span class="math notranslate nohighlight">\(T_{max}=10000\)</span> steps of Markov chain sampling for each computation of <span class="math notranslate nohighlight">\(\langle M \rangle\)</span>. or each <span class="math notranslate nohighlight">\(\epsilon/k_BT\)</span> in the array</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">epsilonRatios</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
<p>compute and store the average chain length in an array of the same size. 🦉Plot the normalized chain length <span class="math notranslate nohighlight">\(\langle M \rangle/N\)</span> versus <span class="math notranslate nohighlight">\(\epsilon/k_BT\)</span> and theck that it matches the following plot.</p>
<!--![image.png](attachment:image.png)-->
<div><img src="https://clark.physics.illinois.edu/246img/MC_rubberBand3.png" width=400  alt="Answer (start)"></img><br></div><p>From this plot, we can see that when <span class="math notranslate nohighlight">\(\epsilon\)</span> is negative flat polymers are energetically preferred and the average length of the rubber band increases. When <span class="math notranslate nohighlight">\(\epsilon\)</span> is positive, bent polymers are more energetically favorable and the average length decreases.</p>
<p>Notice the dependence on temperature. When temperature is very high, the rubber band has a nearly equal number of flat and bent polymers and so is about <span class="math notranslate nohighlight">\(Na/2\)</span> in length. When temperature is low, then the sign of ! determines whether the rubber band is maximally stretched or contracted.</p>
<p>For the typical rubber bands you would get in the store, the polymers within it energetically prefer to lie flat so that <span class="math notranslate nohighlight">\(\epsilon&lt;0.\)</span> . This sign of <span class="math notranslate nohighlight">\(\epsilon\)</span> means that rubber bands contract when heated and expanded when cold!</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div>
<p><strong>Q: What happens when <span class="math notranslate nohighlight">\(\epsilon/k_BT=0\)</span> ? Explain below</strong></p>
<p>A:</p>
<hr class="docutils" />
<p>**Acknowledgements:</p>
<ul class="simple">
<li><p>Eli Chertkov and George Gollin (original)</p></li>
</ul>
<p>© Copyright 2021</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Random%20Walks.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Random Walks</p>
      </div>
    </a>
    <a class="right-next"
       href="Predator-Prey.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Predator-Prey</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-weather-markov-chains">Exercise 1: Weather Markov Chains</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">0. Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-weather-probabilities">a. Weather Probabilities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#information-about-markov-chain-monte-carlo">Information about Markov Chain Monte Carlo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metropolis-algorithm">Metropolis Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-physics-and-the-boltzmann-distribution">Thermal physics and the Boltzmann distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-the-thermodynamics-of-a-paramagnetic-material">Exercise 2: The thermodynamics of a paramagnetic material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-thermodynamics-of-rubber-bands">Exercise 3: Thermodynamics of rubber bands</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rubber-bands-at-infinite-temperature">a. Rubber bands at infinite temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rubber-bands-at-finite-temperature">b. Rubber bands at finite temperature</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark; George Gollin; Ryan Levy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>