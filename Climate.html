
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Climate Dynamics &#8212; Physics 246</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fluid Dynamics" href="FluidDynamics.html" />
    <link rel="prev" title="Predator-Prey" href="Predator-Prey.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/FD.png" class="logo__image only-light" alt="Physics 246 - Home"/>
    <img src="_static/FD.png" class="logo__image only-dark pst-js-only" alt="Physics 246 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An Introduction to Modern Computational Physics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="N_Ways_of_Measuring_PI.html">N ways to measure <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OrbitalDynamics.html">Orbital Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exoplanets.html">Exoplanets</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaos.html">Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticlePhysics.html">Particle Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearningGalaxies.html">Classifying Galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Random%20Walks.html">Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Markov%20Chains.html">Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="Predator-Prey.html">Predator-Prey</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="FluidDynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC1.html">Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2.html">Building a Physical Qubit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/bkclark/IntroductionToComputationalPhysics/blob/main/IntroductionToComputationalPhysics/Climate.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Climate.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Climate Dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-climate-and-global-warming">Exercise 1: Climate and Global Warming</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-temperature-of-the-dark-airless-earth">a. The temperature of the dark airless Earth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-temperature-of-earth-with-air-and-clouds">b. The temperature of Earth with air and clouds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-linearizing-around-the-equilibrium">c. Linearizing around the equilibrium</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-global-warming">d. Global Warming</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-snowball-earth">Exercise 2: Snowball Earth</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-climate-dynamics">a. Climate Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-snowball-earth">b. Snowball Earth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-hysteresis">c. Hysteresis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-one-dimensional-ebm">Exercise 3: One-dimensional EBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-latitude-dependence-of-solar-isolation-and-albedo">a. Latitude dependence of solar isolation and albedo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-a-diffusion-less-planet">b. A diffusion-less planet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-diffusion">c. Diffusion</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="climate-dynamics">
<h1>Climate Dynamics<a class="headerlink" href="#climate-dynamics" title="Link to this heading">#</a></h1>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>climlab
<span class="o">!</span>wget<span class="w"> </span>https://clark.physics.illinois.edu/temp.data
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting climlab
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading climlab-0.8.2.tar.gz (3.1 MB)
?25l     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/3.1 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">3.1/3.1 MB</span> <span class=" -Color -Color-Red">163.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25h
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Installing build dependencies ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> \
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> /
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> -
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>?25h  Getting requirements to build wheel ... ?25ldone
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>?25h  Preparing metadata (pyproject.toml) ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
?25hRequirement already satisfied: numpy in /opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/site-packages (from climlab) (2.0.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting xarray (from climlab)
  Downloading xarray-2024.7.0-py3-none-any.whl.metadata (11 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting scipy (from climlab)
  Downloading scipy-1.13.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (60 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: packaging&gt;=23.1 in /opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/site-packages (from xarray-&gt;climlab) (24.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pandas&gt;=2.0 (from xarray-&gt;climlab)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading pandas-2.2.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (89 kB)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/site-packages (from pandas&gt;=2.0-&gt;xarray-&gt;climlab) (2.9.0.post0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pytz&gt;=2020.1 (from pandas&gt;=2.0-&gt;xarray-&gt;climlab)
  Downloading pytz-2024.2-py2.py3-none-any.whl.metadata (22 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting tzdata&gt;=2022.7 (from pandas&gt;=2.0-&gt;xarray-&gt;climlab)
  Downloading tzdata-2025.1-py2.py3-none-any.whl.metadata (1.4 kB)
Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=2.0-&gt;xarray-&gt;climlab) (1.17.0)
Downloading scipy-1.13.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (38.6 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/38.6 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Green">38.5/38.6 MB</span> <span class=" -Color -Color-Red">256.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">38.6/38.6 MB</span> <span class=" -Color -Color-Red">172.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading xarray-2024.7.0-py3-none-any.whl (1.2 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/1.2 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.2/1.2 MB</span> <span class=" -Color -Color-Red">108.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading pandas-2.2.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.1 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/13.1 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">13.1/13.1 MB</span> <span class=" -Color -Color-Red">208.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading pytz-2024.2-py2.py3-none-any.whl (508 kB)
Downloading tzdata-2025.1-py2.py3-none-any.whl (346 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Building wheels for collected packages: climlab
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Building wheel for climlab (pyproject.toml) ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
?25h  Created wheel for climlab: filename=climlab-0.8.2-py3-none-any.whl size=171484 sha256=cff82caa010c3aeceeac3eb2305a78ec46c2a973c4aa79b41893622758fe7806
  Stored in directory: /home/runner/.cache/pip/wheels/43/d3/a9/8321be4bd1f99169ce1b408fe76d0730937ca8849b600b0d6f
Successfully built climlab
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: pytz, tzdata, scipy, pandas, xarray, climlab
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully installed climlab-0.8.2 pandas-2.2.3 pytz-2024.2 scipy-1.13.1 tzdata-2025.1 xarray-2024.7.0

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">24.3.1</span> -&gt; <span class=" -Color -Color-Green">25.0</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2025-01-27 20:16:18--  https://clark.physics.illinois.edu/temp.data
Resolving clark.physics.illinois.edu (clark.physics.illinois.edu)... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.220.149.166
Connecting to clark.physics.illinois.edu (clark.physics.illinois.edu)|18.220.149.166|:443... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200 OK
Length: 17595 (17K)
Saving to: ‘temp.data’


temp.data             0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>temp.data           100%[===================&gt;]  17.18K  --.-KB/s    in 0.06s   

2025-01-27 20:16:18 (277 KB/s) - ‘temp.data’ saved [17595/17595]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">climlab.solar.insolation</span><span class="w"> </span><span class="kn">import</span> <span class="n">daily_insolation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">climlab.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">climlab</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;random&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="k">return</span>
<span class="n">tempData</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;temp.data&quot;</span><span class="p">)</span>
<span class="n">tempData</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">tempData</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">14.2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.solar.insolation</span><span class="w"> </span><span class="kn">import</span> <span class="n">daily_insolation</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9.21</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">climlab</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">20</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span><span class="p">,</span> <span class="n">thermo</span><span class="p">,</span> <span class="n">legendre</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="c1"># some more useful shorcuts</span>
<span class="ne">---&gt; </span><span class="mi">20</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.model.column</span><span class="w"> </span><span class="kn">import</span> <span class="n">GreyRadiationModel</span><span class="p">,</span> <span class="n">RadiativeConvectiveModel</span><span class="p">,</span> <span class="n">BandRCModel</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.model.ebm</span><span class="w"> </span><span class="kn">import</span> <span class="n">EBM</span><span class="p">,</span> <span class="n">EBM_annual</span><span class="p">,</span> <span class="n">EBM_seasonal</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.domain.field</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">global_mean</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9.21</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">climlab</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">column</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">43</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.domain.initial</span><span class="w"> </span><span class="kn">import</span> <span class="n">column_state</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.domain.field</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<span class="ne">---&gt; </span><span class="mi">43</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.radiation.insolation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixedInsolation</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.radiation.greygas</span><span class="w"> </span><span class="kn">import</span> <span class="n">GreyGas</span><span class="p">,</span> <span class="n">GreyGasSW</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.convection.convadj</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConvectiveAdjustment</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9.21</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">climlab</span><span class="o">/</span><span class="n">radiation</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">15</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.water_vapor</span><span class="w"> </span><span class="kn">import</span> <span class="n">ManabeWaterVapor</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1">#from radiation import Radiation, Radiation_SW, Radiation_LW</span>
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.cam3</span><span class="w"> </span><span class="kn">import</span> <span class="n">CAM3</span><span class="p">,</span> <span class="n">CAM3_LW</span><span class="p">,</span> <span class="n">CAM3_SW</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.rrtm</span><span class="w"> </span><span class="kn">import</span> <span class="n">RRTMG</span><span class="p">,</span> <span class="n">RRTMG_LW</span><span class="p">,</span> <span class="n">RRTMG_SW</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9.21</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">climlab</span><span class="o">/</span><span class="n">radiation</span><span class="o">/</span><span class="n">cam3</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">39</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.utils.thermo</span><span class="w"> </span><span class="kn">import</span> <span class="n">vmr_to_mmr</span>
<span class="ne">---&gt; </span><span class="mi">39</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.radiation.radiation</span><span class="w"> </span><span class="kn">import</span> <span class="n">_Radiation_SW</span><span class="p">,</span> <span class="n">_Radiation_LW</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1">#  Wrapping these imports in try/except to avoid failures during documentation building on readthedocs</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.9.21</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">climlab</span><span class="o">/</span><span class="n">radiation</span><span class="o">/</span><span class="n">radiation</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">86</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.domain.field</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<span class="ne">---&gt; </span><span class="mi">86</span> <span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">warnings</span><span class="o">,</span><span class="w"> </span><span class="nn">pooch</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span> <span class="kn">from</span><span class="w"> </span><span class="nn">climlab.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_datapath_http</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pooch&#39;
</pre></div>
</div>
</div>
</details>
</div>
<section id="exercise-1-climate-and-global-warming">
<h2>Exercise 1: Climate and Global Warming<a class="headerlink" href="#exercise-1-climate-and-global-warming" title="Link to this heading">#</a></h2>
<section id="a-the-temperature-of-the-dark-airless-earth">
<h3>a. The temperature of the dark airless Earth<a class="headerlink" href="#a-the-temperature-of-the-dark-airless-earth" title="Link to this heading">#</a></h3>
<p>Our goal is to start understanding something about the climate.  We first want two functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">IncomingRadiationPerSquareMeter</span><span class="p">():</span>
  <span class="o">...</span>
  <span class="o">...</span>
  <span class="k">return</span> <span class="o">...</span>
</pre></div>
</div>
<p>which returns the incoming radiation to the Earth and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">OutgoingRadiationPerSquareMeter</span><span class="p">():</span>
  <span class="o">...</span>
  <span class="o">...</span>
  <span class="k">return</span> <span class="o">...</span>
</pre></div>
</div>
<p>which returns the outgoing radiation.</p>
<p>We are going to iteratively improve upon these functions to add more realism eventually ending up with a one-dimensional representation of the Earth.</p>
<p>Let us begin, though, with the simplest thing we can do.   The sun is outputting a certain amount of Energy per second.  By the time it has spread out to the orbit of the Earth, it is a flux of</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S=1367.6\)</span> Watts/<span class="math notranslate nohighlight">\(\textrm{m}^2\)</span></p></li>
</ul>
<p>From the Sun’s point of view, the earth is a disc (circle) that is of area <span class="math notranslate nohighlight">\(\pi R^2\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is the radius of the Earth.</p>
<p>From this, we can compute the amount of radiation that is hitting Earth. That radiation, though, is split out over the entire surface of the Earth - an area of <span class="math notranslate nohighlight">\(4\pi R^2\)</span>.</p>
<p>Using this information you should be able to write a function <code class="docutils literal notranslate"><span class="pre">IncomingRadiationPerSquareMeter()</span></code> which specifies how much radiation hits the Earth. Notice that this doesn’t depend on the radius of the Earth <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>To get an estimate of the outgoing radiation, we can use the Stefan-Boltzmann law.   This law tell us that a blackbody (like the Earth) radiates at <span class="math notranslate nohighlight">\(\sigma T^4\)</span> where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma =  5.67 \times 10^{-8}\)</span> W/ (<span class="math notranslate nohighlight">\(m^2\)</span> <span class="math notranslate nohighlight">\(K^4\)</span>)</p></li>
</ul>
<p>We can now right the function <code class="docutils literal notranslate"><span class="pre">OutgoingRadiationPerSquareMeter(T)</span></code> which takes the temperature <span class="math notranslate nohighlight">\(T\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Now we need to find the temperature at which the incoming radiation and the outgoing radiation match.</p>
<p>Do this in two ways. First graph the two functions you’ve written as a function of temperature and determine at temperature <span class="math notranslate nohighlight">\(T\)</span> the two match.</p>
<p>Secondly, let’s just call some optimization.  Define a cost function <code class="docutils literal notranslate"><span class="pre">diff(T)</span></code> which gives the absolute value of the difference between the incoming and outgoing radiation.  Let’s then just minimize this by calling
<code class="docutils literal notranslate"><span class="pre">opt=scipy.optimize.minimize(diff,[10],method='COBYLA',bounds=[(0,300)])</span></code></p>
<p>Report the number you find and compare this with the actual temperature of the Earth which is approximately 14 degrees Celsius (pre-industrial) or 15 degrees Celsius (now).</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-the-temperature-of-earth-with-air-and-clouds">
<h3>b. The temperature of Earth with air and clouds<a class="headerlink" href="#b-the-temperature-of-earth-with-air-and-clouds" title="Link to this heading">#</a></h3>
<p>It turns out that we didn’t find the correct temperature.  We have ignored two important effects.</p>
<p><strong>Albedo</strong></p>
<p>Some fraction of the radiation that is incoming to the Earth simply gets reflected back immediately from things like clouds and ice.  This fraction is approximately <span class="math notranslate nohighlight">\(\alpha=0.3\)</span>.  The incoming radiation per square meter is then instead <span class="math notranslate nohighlight">\(\frac{S}{4}( 1-\alpha)\)</span>.</p>
<p><strong>Greenhouse Gases</strong></p>
<p>In practice, some fraction of the radiation that would typically be radiated back into space is capture by the greenhouse gases in the atmosphere.</p>
<p>We can represent this by including an emissivity term for the atmosphere writing instead that the radiation emitted is <span class="math notranslate nohighlight">\(\epsilon \sigma T^4\)</span>.  We don’t have any good way to calculate <span class="math notranslate nohighlight">\(\epsilon\)</span> from first principles at the moment so instead let’s back it out.  Let’s instead say that the pre-industrial temperature is 14 degrees Celsius.  Calculate using your code what the emissivity have to be?</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-linearizing-around-the-equilibrium">
<h3>c. Linearizing around the equilibrium<a class="headerlink" href="#c-linearizing-around-the-equilibrium" title="Link to this heading">#</a></h3>
<p>We will find it convenient to linearize are outgoing radiation around zero degrees celsius.  This should give us</p>
<div class="math notranslate nohighlight">
\[\epsilon \sigma (T_0 + T_c)^4 \approx \epsilon \sigma(T_0^4 + 4 T_0^3 T_c) = A + BT_c\]</div>
<p>where <span class="math notranslate nohighlight">\(T_0=273.15\)</span> and <span class="math notranslate nohighlight">\(T_c\)</span> is the temperature in Celsius.</p>
<p>This gives us <span class="math notranslate nohighlight">\(A=195.94\)</span> and <span class="math notranslate nohighlight">\(B=2.87\)</span>.</p>
<p>Change your outgoing radiation function to use <span class="math notranslate nohighlight">\(A+BT_c\)</span>.  Your function should take <span class="math notranslate nohighlight">\(T\)</span> in Kelvin but needs to convert it to Celsius to work here.</p>
<p>Again, optimize for the equilibrium temperature.  You’ll actually find that we get a temperature <span class="math notranslate nohighlight">\(T=15.11878309\)</span>.  This is off because the linearization wasn’t great.  We can fix this by instead renormalizing these parameters instead using</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A=221.2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(B=1.3\)</span></p></li>
</ul>
<p>Check that these new parameters give a much closer equilbrium temperature (for the pre-industrial average) of 13.94</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div><p>We will be building up a dictionary with the relevant parameters in it - so far</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="mf">221.2</span>  <span class="p">,</span>
    <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="mf">1.3</span>
    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="d-global-warming">
<h3>d. Global Warming<a class="headerlink" href="#d-global-warming" title="Link to this heading">#</a></h3>
<p>We know that putting carbon dioxide in the atmosphere increases the temperature of the Earth.  We would like to quantify this.  It is known that Carbox dioxide essentially contributes to decreasing the radiation which is emitted from the Earth in a way which is logarithmic to its concentration.  In other words, it corrects our emitted radiation by a term
$<span class="math notranslate nohighlight">\( r \log \left(\frac{CO_{2;current}}{CO_{2;old}}\right) \)</span><span class="math notranslate nohighlight">\(
where \)</span>r=-5$ is a proportionality constant.</p>
<p>Below is the Carbon dioxide that is in the air as a function of year.  Plot it:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CO2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1751.590620307266</span><span class="p">,</span> <span class="mf">277.1900826446281</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1777.9960515400046</span><span class="p">,</span> <span class="mf">278.95316804407713</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1790.6841547040233</span><span class="p">,</span> <span class="mf">279.8347107438017</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1797.1997437701493</span><span class="p">,</span> <span class="mf">280.27548209366387</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1806.8001722200638</span><span class="p">,</span> <span class="mf">281.1570247933884</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1815.0283007970431</span><span class="p">,</span> <span class="mf">282.03856749311296</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1822.9161897361043</span><span class="p">,</span> <span class="mf">282.4793388429752</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1832.8625284845687</span><span class="p">,</span> <span class="mf">282.92011019283746</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1845.5506316485873</span><span class="p">,</span> <span class="mf">283.80165289256195</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1859.9484389931429</span><span class="p">,</span> <span class="mf">285.56473829201104</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1872.9711111344473</span><span class="p">,</span> <span class="mf">287.7685950413223</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1891.8062104235146</span><span class="p">,</span> <span class="mf">293.0578512396694</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1906.8674850620098</span><span class="p">,</span> <span class="mf">298.3471074380165</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1917.128545475548</span><span class="p">,</span> <span class="mf">303.1955922865013</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1926.3717223056487</span><span class="p">,</span> <span class="mf">306.2809917355372</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1930.8288615623721</span><span class="p">,</span> <span class="mf">306.72176308539946</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1936.3010490722172</span><span class="p">,</span> <span class="mf">309.366391184573</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1940.7440116773605</span><span class="p">,</span> <span class="mf">312.0110192837465</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1946.573450807019</span><span class="p">,</span> <span class="mf">312.45179063360877</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1951.3708297016603</span><span class="p">,</span> <span class="mf">313.3333333333333</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1955.8194629674358</span><span class="p">,</span> <span class="mf">315.09641873278235</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1959.9221859346617</span><span class="p">,</span> <span class="mf">317.30027548209364</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1963.6789986033375</span><span class="p">,</span> <span class="mf">319.9449035812672</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1967.0927363037795</span><span class="p">,</span> <span class="mf">322.58953168044076</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1971.1784472891093</span><span class="p">,</span> <span class="mf">327.4380165289256</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1973.903199722768</span><span class="p">,</span> <span class="mf">330.52341597796146</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1976.9625211337122</span><span class="p">,</span> <span class="mf">334.93112947658403</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1980.6994864901762</span><span class="p">,</span> <span class="mf">340.6611570247934</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1982.735253657051</span><span class="p">,</span> <span class="mf">344.1873278236915</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1985.4571707603936</span><span class="p">,</span> <span class="mf">347.71349862258955</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1987.8303422348704</span><span class="p">,</span> <span class="mf">352.1212121212121</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1990.8896636458148</span><span class="p">,</span> <span class="mf">356.5289256198347</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1994.2892246946772</span><span class="p">,</span> <span class="mf">361.37741046831957</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1996.322156531236</span><span class="p">,</span> <span class="mf">365.3443526170799</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1999.3786426118645</span><span class="p">,</span> <span class="mf">370.1928374655647</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2003.7762399319522</span><span class="p">,</span> <span class="mf">379.88980716253445</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2006.4896510443468</span><span class="p">,</span> <span class="mf">384.73829201101927</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2010.5498440568329</span><span class="p">,</span> <span class="mf">393.55371900826447</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2012.2397009251579</span><span class="p">,</span> <span class="mf">397.5206611570248</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2014.9361000556567</span><span class="p">,</span> <span class="mf">405.0137741046832</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2016.9690318922155</span><span class="p">,</span> <span class="mf">408.9807162534435</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2019.6654310227143</span><span class="p">,</span> <span class="mf">416.4738292011019</span><span class="p">],</span>
<span class="p">[</span><span class="mf">2020.6833146061517</span><span class="p">,</span> <span class="mf">418.23691460055096</span><span class="p">]])</span>

<span class="c1">### Plot Here</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Now, modify your code to include this additional forcing term into the emitted radiation.</p>
<p>Compute the equilibrium temperature at the value of carbon dioxide for each year and graph this equilibrium temperature against the year.  Plot it on top of the actual measured temperature which is in <code class="docutils literal notranslate"><span class="pre">tempData[:,1]</span></code> (where the year is in <code class="docutils literal notranslate"><span class="pre">tempData[:,0]</span></code>).   Notice the close agreement between the predicted temperature based on the CO2 and our 0D EBM vs the actual temperature (actually the prediction is probably closer then it should be expected given the spherical cow nature of our approximation)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="mf">221.2</span>  <span class="p">,</span>
    <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
    <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;Current_CO2&#39;</span> <span class="p">:</span> <span class="o">...</span>
    <span class="p">}</span>
</pre></div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Now, in this model, let’s compute how much more carbon dioxide we can add to the atmosphere before we can reach two degrees of temperature increase from the 1850 baseline. If we assume that you continue to increase the CO2 in the atmosphere at the same rate that we have been in the last 20 years, what year do we reach a two degree warming.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-2-snowball-earth">
<h2>Exercise 2: Snowball Earth<a class="headerlink" href="#exercise-2-snowball-earth" title="Link to this heading">#</a></h2>
<section id="a-climate-dynamics">
<h3>a. Climate Dynamics<a class="headerlink" href="#a-climate-dynamics" title="Link to this heading">#</a></h3>
<p>So far we’ve mainly figured out what the equilibrium temperature of the Earth has to be - i.e. the Sun shines on the Earth for a long period of time and eventually it heats the Earth up so that the radiation the Earth is radiating back to space is equivalent to the radiation that is being absorbed.</p>
<p>In this exercise, we are going to start by dealing with the word eventually.  We’d like to understand how long it takes the temperature to approach to equilibrium temperature - this, of course, depends on what we mean by heating up the Earth to that temperature.</p>
<p>It shouldn’t surprise us that we to answer this question, we should start by writing down a differential equation that tells us <span class="math notranslate nohighlight">\(\partial T / \partial t\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is the temperature and <span class="math notranslate nohighlight">\(t\)</span> is the time.</p>
<div class="math notranslate nohighlight">
\[ C \frac{\partial T}{\partial t} = \frac{S}{4}(1-\alpha) - (A+B T) \]</div>
<p>(remember in <span class="math notranslate nohighlight">\(BT\)</span> we need that <span class="math notranslate nohighlight">\(T\)</span> is in Celsius).</p>
<p>The r.h.s. of this is just the radiation into the Earth and the radiation out of Earth that we were working on in exercise 1.  Previously, we were just setting this r.h.s. to zero - i.e. we wanted the temperature at which the change in temperature over time was zero.</p>
<p>But when it’s not zero, it’s telling us how much the temperature changes in a unit of time.  If there is more radiation coming in then going out, we expect that the temperature of the planet should heat up.</p>
<p>The <span class="math notranslate nohighlight">\(C\)</span> is the heat capacity of the planet - it’s telling us if we put a certain amount of radiation in per second how long does that take to actually heat up the Earth.  If the Earth were a big chunk of iron it would heat up pretty quickly (think a pot). On the other hand, if it was a big chunk of granite, it would heat up quite slowly.  It turns out that Earth (at least the relevant part that’s heating up) is essentially a big bag of water - i.e. a big ocean.  It’s a little subtle to figure out which part of the ocean is heating up but a reasonable answer here turns out to be the top 10 meters.  In such a case, the heat capacity is going to be <span class="math notranslate nohighlight">\(C=4.18130000e+07\)</span>.</p>
<p>Go ahead and set up a first order integrator for this system.  Use a time step <span class="math notranslate nohighlight">\(dt\)</span> of 1 month (written in seconds!). You can use <code class="docutils literal notranslate"><span class="pre">const.seconds_per_month</span></code> to get the correct number of seconds.</p>
<p>Start the temperature of the Earth at 295 degrees Kelvin and allow that temperature to evolve in time.  Plot the temperature as a function of time (in years).</p>
<p>We want to observe three things:</p>
<ul class="simple">
<li><p>What is the equilibrium temperature?</p></li>
<li><p>What is the functional form for approaching the equilibrium temperature?</p></li>
<li><p>How long does it take to get there?</p></li>
</ul>
<p>Try a similar thing starting from a temperature which is less 270 degrees Kelvin.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You should have observed the following things:</p>
<ul class="simple">
<li><p>The planet eventually equilibrates to the temperature that you predicted in exercise 1. This is the fixed point of that equation (i.e. if you start there you stay there).</p></li>
<li><p>The approach to that equilibrium is exponential.  You actually could have deduced this even analytically by looking at the form of the differential equation.  This tells you that if you are out of equilibrium that you end up getting pushed back towards the equilibrium temperature relatively quickly (both from above and below). The equilibrium temperature is a stable fixed point - if you push away from it, you flow back to it.</p></li>
<li><p>The time scale to fix a 5 degree difference from equilibrium is on the order of a decade.</p></li>
</ul>
<p>It is interesting to ask how long it would take to relax back to the equilibrium temperature if you start 100 degrees Celsius away.</p>
</section>
<section id="b-snowball-earth">
<h3>b. Snowball Earth<a class="headerlink" href="#b-snowball-earth" title="Link to this heading">#</a></h3>
<p>We have seen that the Earth is very stable and largely independent of the initial temperature. But we are missing some important qualitiative physics.  In particular, once water gets cold enough it freezes into ice.  This ice is actually much more reflective of the Sun and so the albedo is therefore much higher.  This tells us that we should have the albedo (and hence the radiation entering the planet) depend on temperature.</p>
<ul class="simple">
<li><p>If the temperature <span class="math notranslate nohighlight">\(T&lt;-10\)</span> degrees celsius, then we should have the albedo be <span class="math notranslate nohighlight">\(\alpha_i = 0.5\)</span></p></li>
<li><p>If the temperature <span class="math notranslate nohighlight">\(T&gt;10\)</span> degrees celsius, then we should have the albedo be <span class="math notranslate nohighlight">\(\alpha_0 = 0.3\)</span></p></li>
<li><p>In the intermediate regime <span class="math notranslate nohighlight">\(-10 &lt; T &lt; 10\)</span> we can adjust it continuously as <span class="math notranslate nohighlight">\(\alpha_i + (\alpha_0-\alpha_i)(T+10)/20\)</span></p></li>
</ul>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">GetAlpha(T)</span></code> which returns the temperature dependent albedo and plot the albedo for temperatures from <span class="math notranslate nohighlight">\(-20 &lt; T &lt; 20\)</span> degrees Celsius</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Now we want to incorporate our new temperature dependent albedo in our code.</p>
<p>What we want to do is loop over a large number of initial temepratures from <span class="math notranslate nohighlight">\(T=-50\)</span> to <span class="math notranslate nohighlight">\(T=100\)</span> degrees Celsius and then examine what the temperature is as a function of time.</p>
<ul class="simple">
<li><p>Plot temperature as a function of time for mamy different initial temperatures (all plotted as a different line).</p></li>
<li><p>Secondly, for each initial temperature, figure out what the final fixed point temperature is. Plot the fixed point temperature on the y-axis as a function of the initial temperature.</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>What you should find is two stable fix points (and one unstable fixed point).  The final temperature that the Earth evolves too depends on the initial temperature.  This is coming from negative feedack due to the ice.  Once you get cold enough, you end up with enough ice that causes it to even get colder. And then once you evolve to a sufficiently cold value it is quite hard to recover.</p>
<p>There is some geological evidence that either all (or a very large fraction) of the Earth was covered by glacial ice. This is called the snowball Earth.</p>
<p>This model gives a mechanism for how such a thing might happen. Consider a scenario where you have a temperature fluctuation for various reasons for a decade;  maybe there is anomolous volcanic activity which puts dust in the atmosphere temporarily raising the albedo or maybe there is a change in the solar insolation because of some orbital oscillation.  Within a decade you might be in a situation which is very hard to recover from.</p>
</section>
<section id="c-hysteresis">
<h3>c. Hysteresis<a class="headerlink" href="#c-hysteresis" title="Link to this heading">#</a></h3>
<p>This phenomena is essentially one of Hysteresis.  Let’s see this explicitly.  Let’s start with a warm planet (10 degrees Celsisus) and the current solar insolation. Now let’s do the following:</p>
<ul class="simple">
<li><p>for step in range(0,10):</p>
<ul>
<li><p>Wait 5 years</p></li>
<li><p>Plot the final temperature vs the current solar insolation</p></li>
<li><p>Decrease the value of Q=S/4 by 5 W/m^2 (i.e <code class="docutils literal notranslate"><span class="pre">S-=20</span></code>)</p></li>
</ul>
</li>
</ul>
<p>Then do the same thing but in reverse increasing the solar insolation by 5 W/m^2 at each step.  This time do it for 30 steps.</p>
<p>Both of these line should be on the same plot.  Notice that there is a hystersis.  Even after the solar insolation has gotten back to where it was, you are still not back to your original temperature. In fact, there’s essentially no way to get back to your original temperature this way because you need to way overshoot before you melt the planet.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-3-one-dimensional-ebm">
<h2>Exercise 3: One-dimensional EBM<a class="headerlink" href="#exercise-3-one-dimensional-ebm" title="Link to this heading">#</a></h2>
<p>We want to implement a more accurate climate model.  Previously, we had worked on a zero-dimensional model.  To add some realism to this model, we are going to add an additional dimension splitting up the world into different latititudes.  This is the most important effect that we are missing as these different latitudes get significantly different sunlight.</p>
<p>The energy balance model that we will work with will be</p>
<div class="math notranslate nohighlight">
\[ C \frac{dT_s(\phi)}{dt} = (1-\alpha(\phi;T)) Q(\phi) - (A+B T_s(\phi)) + \frac{D}{\cos⁡\phi } \frac{\partial }{\partial \phi} \left(   \cos⁡\phi  ~ \frac{\partial T}{\partial \phi} \right)\]</div>
<section id="a-latitude-dependence-of-solar-isolation-and-albedo">
<h3>a. Latitude dependence of solar isolation and albedo<a class="headerlink" href="#a-latitude-dependence-of-solar-isolation-and-albedo" title="Link to this heading">#</a></h3>
<p>The first thing you should notice is that there are now a lot of different terms that depend on the latitude.</p>
<p>To do that you need to discretize the Earth into a number of different latitude zones.  You could just discretize your own latitudes but because we need to sync our functions with yours, we will give you the latitude zones that you are going to use.  You can get them by calling the following function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">GetLatitudes</span><span class="p">():</span>
  <span class="n">sfc</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">zonal_mean_surface</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">water_depth</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
  <span class="n">lat</span> <span class="o">=</span> <span class="n">sfc</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">points</span>
  <span class="k">return</span> <span class="n">lat</span>
</pre></div>
</div>
<p>The first thing that depends on latitude which is important is the amount of radiation from the Sun is being deposited on different parts of the Earth.  We know that the equator gets significantly more sunlight then the poles.  In principle, we should adjust how much each pole gets depending on the season (summer vs winter).  This is an interesting extension you can do but we will start by just assigning an average amount of Sun that touches the different parts of the Earth.</p>
<p>You can get this by calling the following function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">GetInsolation</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
  <span class="n">model1</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;EBM with interactive ice line&#39;</span><span class="p">,</span>
                            <span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">seconds_per_month</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">param</span><span class="p">)</span>
  <span class="n">Q</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">model1</span><span class="o">.</span><span class="n">insolation</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">Q</span>
</pre></div>
</div>
<p>which will return the amount of watts per square meter of each latitude zone on the Earth.</p>
<p>We will actually need to send this a set of parameters (which tells us things like the values of differnet coefficients. Here are the parameters we will use (we will explain them in due time))</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">210</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mf">0.354</span><span class="p">,</span>
    <span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">,</span>
    <span class="s1">&#39;ai&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;Tf&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span>
    <span class="s1">&#39;CO2&#39;</span><span class="p">:</span><span class="mf">283.</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mf">4.18130000e+07</span><span class="p">,</span>
    <span class="s1">&#39;r&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;timeStep&#39;</span><span class="p">:</span><span class="n">const</span><span class="o">.</span><span class="n">seconds_per_month</span>
    <span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Go ahead and plot this as as a function of latitude</p></li>
<li><p>Measure the average radiation on the Earth and verify that it is approximately 1370/4 (the number we were using before). You need to be careful when you do this.  When averaging over a sphere, you need to weight by the volume at that latitude (i.e. <span class="math notranslate nohighlight">\(\cos \phi\)</span>).  It will behoove you to write a function which takes a array over the latitudes and averages them correctly (we will need this for the average temperature of the planet as well).</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>The next thing that we need to deal with is the latitude dependence of the albedo.  As we saw in the 0D model, the albedo will change its reflectivity when things freeze.   We are going to do something a little simpler and just have the albedo be <span class="math notranslate nohighlight">\(\alpha_i = 0.5\)</span> (see parameters above) when the temperature <span class="math notranslate nohighlight">\(t_f&lt;-10\)</span> Celsius.</p>
<p>But there is also an effect of the albedo that is coming from the latitude. In particular, because the Sun is shining at more of an angle closer to the poles.</p>
<p>If the temperature is greater then <span class="math notranslate nohighlight">\(-10 &lt; t_f\)</span> then we should have an Albedo of <span class="math notranslate nohighlight">\(\alpha_0 + a_2 P_2(\sin \phi)\)</span> where <span class="math notranslate nohighlight">\(P_2\)</span> is the second legendre polynomial and can be gotten by doing <code class="docutils literal notranslate"><span class="pre">legendre.P2(x)</span></code>.</p>
<p>We’ve given you some initial conditions which you can get by doing the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">GetInitial</span><span class="p">(</span><span class="n">lat</span><span class="p">):</span>
  <span class="n">initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">12.</span> <span class="o">-</span> <span class="mf">40.</span> <span class="o">*</span> <span class="n">legendre</span><span class="o">.</span><span class="n">P2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">))))</span><span class="o">+</span><span class="mf">273.15</span>
  <span class="k">return</span> <span class="n">initial</span>
<span class="n">initialTemperature</span><span class="o">=</span><span class="n">GetInitial</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
</pre></div>
</div>
<p>Go ahead and write a function which generates the Albedo when given an array of temperatures (and the parameters).  Then plot the initial temperature and (separately) what the Albedo looks like for the initialTemperature. Also compute the average of the initial temperature.  Your albedo should have some values at 0.5.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-a-diffusion-less-planet">
<h3>b. A diffusion-less planet<a class="headerlink" href="#b-a-diffusion-less-planet" title="Link to this heading">#</a></h3>
<p>We are now in a position to deal with the incoming and outgoing radiation (but not yet the diffusion).  This is implementing the same energy balance that you had previously except that now you are going to simultaneously deal with all the latititudes. Write a function to time evolve this for 100 years.</p>
<ul class="simple">
<li><p>Plot the average temperature vs time (getting a point once a year)</p></li>
<li><p>Plot the final temperature profile</p></li>
<li><p>The final temperature difference between the equator and the pole (i.e. just the max - min difference)</p></li>
</ul>
<p>You should be running with time steps of 1 month.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You should get a pretty crazy result in this case. Essentially every latitude is doing its own thing (there are no independent because there is no talking between latitudes).  Thereroe, you’re going to see some pretty sharp jumps in the temperature as you change latitudes.  In addition, there is a large (~117 degrees) difference between the poles and the equator.</p>
</section>
<section id="c-diffusion">
<h3>c. Diffusion<a class="headerlink" href="#c-diffusion" title="Link to this heading">#</a></h3>
<p>We are missing an important piece of the physics once we’ve moved to 1D.  The temperature at different latitudes can interact with each other.  Temperature can move both by diffusion and advection.  Here we are going to concern ourself primarily with diffusion.  We’ve seen diffusion before in this class but typically as <span class="math notranslate nohighlight">\(\partial^2/ \partial x^2\)</span>.  In our case though we are on a sphere and need to do something different essentially writing our gradient in spherical coordinates - see the last term of our energy balance model.</p>
<p>We’d like to go ahead and implement the diffusion just like we’ve done in previous cases using a finite difference stencil. Unfortunately, this won’t work here (we run into numerical instabilities at the poles). What we need to do is use an implicit solver of our differential equations.  This is out of scope for this assignment, so instead we will give you a function you can call</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Diffuse</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
  <span class="n">sfc</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">zonal_mean_surface</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">water_depth</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
  <span class="n">Ts</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">domain</span><span class="o">=</span><span class="n">sfc</span><span class="p">)</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">MeridionalHeatDiffusion</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Diffusion&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="n">Ts</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span><span class="n">timestep</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;timeStep&#39;</span><span class="p">])</span>
  <span class="n">d</span><span class="o">.</span><span class="n">step_forward</span><span class="p">()</span>
  <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ts</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">T</span>
</pre></div>
</div>
<p>by going</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="n">Diffuse</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>This will defuse through a time-step of <span class="math notranslate nohighlight">\(\delta T\)</span>.  This said, <strong>there is an extra 30 points extra credit if you can right your own diffuse function which does the diffusion correctly without using libraries. You will almost certainly need implicit solvers to do this</strong>.</p>
<p>Go ahead and put everything together now.  You should be calling the diffusion every time-step as well.</p>
<ul class="simple">
<li><p>Plot the average temperature vs time (getting a point once a year)</p></li>
<li><p>Plot the final temperature profile</p></li>
<li><p>The final temperature difference between the equator and the pole (i.e. just the max - min difference)</p></li>
<li><p>The ice line: the latitude at which the temperature becomes less then -10.</p></li>
</ul>
<p>The diffusion constant <span class="math notranslate nohighlight">\(D\)</span> has been tuned to give a reasonable difference between the poles and the Earth.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You don’t have to do this but you can also experiment with various snowball Earth scenarios with this model.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Predator-Prey.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Predator-Prey</p>
      </div>
    </a>
    <a class="right-next"
       href="FluidDynamics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluid Dynamics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-climate-and-global-warming">Exercise 1: Climate and Global Warming</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-temperature-of-the-dark-airless-earth">a. The temperature of the dark airless Earth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-temperature-of-earth-with-air-and-clouds">b. The temperature of Earth with air and clouds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-linearizing-around-the-equilibrium">c. Linearizing around the equilibrium</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-global-warming">d. Global Warming</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-snowball-earth">Exercise 2: Snowball Earth</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-climate-dynamics">a. Climate Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-snowball-earth">b. Snowball Earth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-hysteresis">c. Hysteresis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-one-dimensional-ebm">Exercise 3: One-dimensional EBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-latitude-dependence-of-solar-isolation-and-albedo">a. Latitude dependence of solar isolation and albedo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-a-diffusion-less-planet">b. A diffusion-less planet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-diffusion">c. Diffusion</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark; George Gollin; Ryan Levy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>