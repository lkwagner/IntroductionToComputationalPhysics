
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Random Walks &#8212; Physics 246</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Random Walks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markov Chains" href="Markov%20Chains.html" />
    <link rel="prev" title="Classifying Galaxies" href="MachineLearningGalaxies.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/FD.png" class="logo__image only-light" alt="Physics 246 - Home"/>
    <img src="_static/FD.png" class="logo__image only-dark pst-js-only" alt="Physics 246 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An Introduction to Modern Computational Physics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="N_Ways_of_Measuring_PI.html">N ways to measure <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OrbitalDynamics.html">Orbital Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exoplanets.html">Exoplanets</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaos.html">Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticlePhysics.html">Particle Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearningGalaxies.html">Classifying Galaxies</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Markov%20Chains.html">Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="Predator-Prey.html">Predator-Prey</a></li>
<li class="toctree-l1"><a class="reference internal" href="Climate.html">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="FluidDynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC1.html">Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2.html">Building a Physical Qubit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/bkclark/IntroductionToComputationalPhysics/blob/main/IntroductionToComputationalPhysics/Random Walks.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Random Walks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Random Walks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-unbiased-random-walks">Exercise 1: Unbiased Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simulating-a-random-walk">a. Simulating a random walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-random-walk-averages">b. Random Walk Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-the-full-distribution">c. The Full Distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-modeling-the-diffusion-deterministically">Exercise 2:  Modeling the diffusion deterministically</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-representing-the-initial-distribution">a. Representing the initial distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-time-evolving-the-distribution">b.  Time evolving the distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-two-dimensional-random-walks">Exercise 3:  Two Dimensional Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">a. Simulating a Random Walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-self-similarity">b. Self Similarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-standard-deviation">c. Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-animation-extra-credit-5-points">d.  Animation (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-diffusion-limited-aggregation">Exercise 3: Diffusion Limited Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-dla-onto-a-core-point-at-the-origin">a. DLA onto a core point at the origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-dla-onto-a-surface-extra-credit-5-points">b. DLA onto a surface (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-symmetry-restoration">Exercise 4: Symmetry Restoration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-one-dimensional-discrete-walks">a. One dimensional Discrete Walks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rotational-invariance-in-2d">b. Rotational Invariance in 2D</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="random-walks">
<h1>Random Walks<a class="headerlink" href="#random-walks" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<p>Remember to execute this cell to load numpy and pylab.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="c1">#from jax.config import config</span>
<span class="c1">#config.update(&quot;jax_enable_x64&quot;, True)</span>
<span class="c1">#from jax import jit, grad</span>
<span class="c1">#import jax.numpy as jnp</span>
<span class="c1">#import jax</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;math&#39;</span><span class="p">,</span><span class="s1">&#39;jax&#39;</span><span class="p">,</span><span class="s1">&#39;jnp&#39;</span><span class="p">,</span><span class="s1">&#39;jit&#39;</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;HTML&#39;</span><span class="p">,</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span><span class="s1">&#39;animateMe_singlePendula&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="k">return</span>
<span class="n">resetMe</span><span class="p">()</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2025, 1, 21, 16, 9, 38, 786769)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### animation code</span>

<span class="c1">### walks should be a 2d numpy array</span>
<span class="k">def</span><span class="w"> </span><span class="nf">Animate1D</span><span class="p">(</span><span class="n">walks</span><span class="p">,</span><span class="n">make_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">walks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">walks</span><span class="p">)</span>
    <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">walks</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walks</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">max_val</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">make_hist</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 10 RGB colors</span>
    <span class="n">scatters</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">myBins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span> <span class="o">*</span> <span class="n">max_val</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">max_val</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">myBins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">myBins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">myBins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">width</span><span class="o">=</span><span class="n">myBins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">myBins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
        <span class="n">scatters</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
        <span class="n">scatters</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">make_hist</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">scatters</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">bars</span><span class="p">:</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">scatters</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">bars</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">walks</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
        <span class="n">scatters</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">make_hist</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">scatters</span><span class="p">]</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">walks</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">myBins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">height</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">hist</span><span class="p">):</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">scatters</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">bars</span><span class="p">)</span>

    <span class="c1">###play only once</span>
    <span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_jshtml</span><span class="p">()))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="exercise-1-unbiased-random-walks">
<h2>Exercise 1: Unbiased Random Walks<a class="headerlink" href="#exercise-1-unbiased-random-walks" title="Link to this heading">#</a></h2>
<p>In this exercise we are going to start by modeling a random walk.  A random walk starts at some location <span class="math notranslate nohighlight">\(x_0\)</span> at a time <span class="math notranslate nohighlight">\(t=0\)</span> and then continues to take random steps at each next unit in time.  Letting, <span class="math notranslate nohighlight">\(x_0=0\)</span>, we can model future steps as</p>
<div class="math notranslate nohighlight">
\[ x_t = x_{t-1} + \delta\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is a random step.
Lots of different physical processes could be modelled by random walks:</p>
<ul class="simple">
<li><p>Dust in the air (or pollen in water): One of the earliest use of random walks was by Einstein who explained an observation of Robert Brown (see <a class="reference external" href="https://physicsworld.com/a/einsteins-random-walk/">here</a> )  who saw grains of pollen suspended in water bouncing randomly.  This random bouncing comes from large numbers of invisible atoms colliding with the grains of pollen causing them to randomly jiggle.  Einstein analyzed this effect and argued that it was strong evidence for the existence of atoms despite not being able to see them.</p></li>
<li><p>Coin Flips:  Consider flipping a coin many times treating heads as +1 and tails as -1.  We can think of the coin flips as a random walk and the total sum as the surplus of heads over tails.</p></li>
<li><p>A person randomly taking steps left and right with each step.</p></li>
</ul>
<p>Each of these cases can be represented by a random walk although we might have to use a different step for <span class="math notranslate nohighlight">\(\delta\)</span>.   For example, in the case of a coin-flip we should let <span class="math notranslate nohighlight">\(\delta\)</span> be either +1 or -1 whereas for a person walking we might let <span class="math notranslate nohighlight">\(\delta\)</span> by selected continuously from some range.  For most of this exercise, let us use</p>
<div class="math notranslate nohighlight">
\[ 
\delta = \sigma N(0,1)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a number which represents an effective step-size and <span class="math notranslate nohighlight">\(N(0,1)\)</span> is a gaussian with mean 0 and standard deviation 1 generated by <code class="docutils literal notranslate"><span class="pre">np.random.randn()</span></code></p>
<p>Notice that for each of these walks, if we were to watch just one walk - e.g. a single person moving back and forth or a single pollen -  it would look pretty random.   It’s only if we look at where the particle is at a moment in time over the distribution of many walks, can we say something quantitative about where we think the particle (or coin sum or person) might be.</p>
<section id="a-simulating-a-random-walk">
<h3>a. Simulating a random walk<a class="headerlink" href="#a-simulating-a-random-walk" title="Link to this heading">#</a></h3>
<p>Let’s start by writing code which simulates a random walk.  Your goal is to write a function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">RandomWalk</span><span class="p">(</span><span class="n">NumSteps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
  <span class="c1"># do stuff</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">myWalk</span><span class="p">)</span>
</pre></div>
</div>
<p>which takes a step-size <code class="docutils literal notranslate"><span class="pre">sigma</span></code> and a number of steps and returns a numpy array that gives the walk at each step.  Make sure that your first location in your myWalk array is the origin.</p>
<p>Generate 10 different random walks each of 1000 steps with step-sizes of <span class="math notranslate nohighlight">\(\sigma=6\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">walks</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">walk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">walks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomWalk</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">walks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">walks</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have these 10 random walks, we can visualize them in various ways:</p>
<ul class="simple">
<li><p>Plot the location <span class="math notranslate nohighlight">\(x\)</span> as a function of the time-step <span class="math notranslate nohighlight">\(t\)</span>.  Notice how these walks all start at the origin and be spread out.</p></li>
<li><p>Animate the walks by calling <code class="docutils literal notranslate"><span class="pre">Animate1D(walks)</span></code>.  This may take about 30 seconds to run and will show you your 10 individual walks wandering around.</p></li>
</ul>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-random-walk-averages">
<h3>b. Random Walk Averages<a class="headerlink" href="#b-random-walk-averages" title="Link to this heading">#</a></h3>
<p>Since each random walk is different, it is useful to look at properties of the distribution over walks.  We are going to start by computing averages over a large number of walks.   The properites we will focus on is</p>
<p>(1) The average <span class="math notranslate nohighlight">\(\langle x_t\rangle\)</span> over the walks at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>(2) The mean absolute deviation (MAD) <span class="math notranslate nohighlight">\(\langle |x_t| \rangle\)</span> over the walks at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>(3) The standard deviations <span class="math notranslate nohighlight">\(\sqrt{\langle x_t^2 \rangle - \langle x_t \rangle^2}\)</span> over the walks.</p>
<p>For a random walk of 1000 steps each of these three quantities should be arrays of lengths 1001 (because you start at zero).<br />
Like when you plotted the walks, you could generate all the walks and then produce these curves.  We will want to compute these quantities over 10,000 walks though so this is inefficient in terms of RAM used.  Instead, you can loop over the 10,000 walks and add each walk to a running average.</p>
<p>Make a plot of these three curves all on the same plot.  Things of note:</p>
<ul class="simple">
<li><p>The average is essentially zero. With a little thought you can convince yourself that (being statistically equal to) zero is the expected answer.  Since it’s just as likely that you go left as right, on average you don’t go anywhere.</p></li>
<li><p>The farthest distance you could expect to get from the origin (i.e. as seen by the MAD or the standard deviation) would be linear in time.  This is what happens when you just always step right.  This is called ballistic motion.</p></li>
<li><p>The average distance of the distribution over walks is significantly slower then this (as might be expected since half the time you’re heading back toward the origin).   In fact it goes as <span class="math notranslate nohighlight">\(\sqrt{t}\)</span>.  This is called diffusive motion.  <strong>Verify that your standard deviation scales this way by making a log-log plot of the standard deviation</strong>.  You should find that</p>
<ul>
<li><p>On a log-log plot the standard deviation is linear (which means that <span class="math notranslate nohighlight">\(\sigma \propto t^\alpha\)</span>).  Don’t graph the t=0 point at the origin.</p></li>
<li><p>Find the value of <span class="math notranslate nohighlight">\(\alpha\)</span> by computing the slope of your (log-log) plot using <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code>.  Show it goes as <span class="math notranslate nohighlight">\(t^{-1/2}\)</span></p></li>
</ul>
</li>
</ul>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="c-the-full-distribution">
<h3>c. The Full Distribution<a class="headerlink" href="#c-the-full-distribution" title="Link to this heading">#</a></h3>
<p>So far we’ve been looking at some summary statistics as of the distribution such as the average and standard deviation.  Now, we’d like to look at the full distribution over walks.</p>
<p>We will start by generating the 10 walks (don’t plot them) that we generated earlier and this time animating them with  <code class="docutils literal notranslate"><span class="pre">Animate1D(walks,make_hist=True)</span></code>.  This time the animation of the particles bouncing around will be generated with a histogram on top which gives the full distribution of the walks.  At the beginning you should see the histogram has all 10 particles in one places.  During the animiation, it will quickly end up each bin has only one particle in it although occassionally you will see 2 (and maybe 3) particles per bin.  Go ahead and animate it.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div><p>Now let’s do this again but instead of just 10 walks, let’s do it with 1000 walks.  Here the histogram is a better representation of the distribution over many walks.  As a function of time you should see something that looks like a Gaussian spreading out.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Now instead of animating this, we’d like to plot a histogram of the distribution after  2 steps, 10 steps, 100 steps, and 500 steps.</p>
<p>To do this, you want to plot a histogram of your distribution - i.e. something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">walks_step100</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=200&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Do this for 100,000 walks.  As earlier, it makes sense to loop over each walk but not simultaneously store all 100,000 walks at once.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You should see the distribution always looks gaussian with the width of the gaussian growing as the number of steps grow.  Notice that from these distributions, we can also compute the various quantities - i.e  <span class="math notranslate nohighlight">\(\sigma_{100} = \sqrt{\langle x_{100}^2 \rangle - \langle x_{100} \rangle^2}\)</span> that we compute above.  We can take the output of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">values</span><span class="p">,</span><span class="n">edges</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">walks_step100</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">delta_x</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mf">2.</span>
</pre></div>
</div>
<p>which should give us the (normalized) values of the histogram and the centers of the bins.  From the variables <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">delta_x</span></code> and  <code class="docutils literal notranslate"><span class="pre">center</span></code> compute <span class="math notranslate nohighlight">\(\sigma_{100}\)</span> and verify that it is (essentially) the same value that you discovered above. To do this you will need to take an integral.  Think about how to get that integral from this information.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Notice that both from the animation and from the histograms you’ve produced below, it seems pretty clear that while each random walk is,  well random, there is something deterministic about the distribution as it changes in time.  In the next exercise, we will try to model the deterministic diffusion of the distribution as a function of time.</p>
</section>
</section>
<section id="exercise-2-modeling-the-diffusion-deterministically">
<h2>Exercise 2:  Modeling the diffusion deterministically<a class="headerlink" href="#exercise-2-modeling-the-diffusion-deterministically" title="Link to this heading">#</a></h2>
<section id="a-representing-the-initial-distribution">
<h3>a. Representing the initial distribution<a class="headerlink" href="#a-representing-the-initial-distribution" title="Link to this heading">#</a></h3>
<p>In this exercise, we’d like to deterministically model how the distribution over random walks changes in time.  What this means is that we want to have some equation of motion that starts with the histogram at step <span class="math notranslate nohighlight">\(t=1\)</span> and then generates the histogram at other time step <span class="math notranslate nohighlight">\(t\)</span>.  In the dynamics section, we stored the position and velocity of a planet at a moment in time. Now, we have to store a vector which stores the entire histogram or distribution at a moment in time.</p>
<p>Start with a vector in the initial condition  <span class="math notranslate nohighlight">\(\rho(t=1)=\exp[-x^2/2\sigma^2]\)</span> where <span class="math notranslate nohighlight">\(\sigma=6\)</span> which we can represent on a grid with <span class="math notranslate nohighlight">\(dx=1\)</span> as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span><span class="o">=</span><span class="mi">4000</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xs</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<p>Go ahead and plot this as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">))</span>
</pre></div>
</div>
<p>(we scale it so that the integral of our density is 1.0 like <code class="docutils literal notranslate"><span class="pre">density=True</span></code> does when we generate a histogram).</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-time-evolving-the-distribution">
<h3>b.  Time evolving the distribution<a class="headerlink" href="#b-time-evolving-the-distribution" title="Link to this heading">#</a></h3>
<p>Now we need an equation of motion which tells us how to change the distribution.  Stochastic random walks are represented by the diffusion equation:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial \rho}{\partial t} = D \frac{\partial^2 \rho}{\partial x^2}\]</div>
<p>Here <span class="math notranslate nohighlight">\(D=a^2/2\)</span> is the diffusion constant where <span class="math notranslate nohighlight">\(a\)</span> is our step size (in this case 6).</p>
<p>To time-step with this differential equation, we need to figure out how to take <span class="math notranslate nohighlight">\(\rho\)</span> and  apply <span class="math notranslate nohighlight">\(\frac{\partial^2 \rho}{\partial x^2}\)</span>.  We will assume that <span class="math notranslate nohighlight">\(\rho=0\)</span> at the boundary at all time so we don’t have to worry about the boundary conditions.  To apply this partial derivative what we should do is use the finite-difference stencil that</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial^2 \rho}{\partial x^2} = \frac{\rho(x+dx) - + \rho(x-dx) -2 \rho(x)}{dx^2}\]</div>
<p>Again we have that <span class="math notranslate nohighlight">\(dx=1\)</span> and we will use <span class="math notranslate nohighlight">\(dt=dx^2/100\)</span>.  Using this, write a function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Step</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dx</span><span class="p">):</span>
   <span class="c1"># compute d^2rho/dx^2</span>
   <span class="c1"># put in the constant and step</span>
   <span class="k">return</span> <span class="n">rho</span> 
</pre></div>
</div>
<p>which takes the vector representing <span class="math notranslate nohighlight">\(\rho\)</span> and moves it forward <span class="math notranslate nohighlight">\(dt\)</span>.  (It may be helpful to use <code class="docutils literal notranslate"><span class="pre">np.roll(rho,1)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.roll(rho,-1)</span></code>)</p>
<p>Compare the distribution that you get at times <span class="math notranslate nohighlight">\(t=2.0, t=10.0\)</span>, and <span class="math notranslate nohighlight">\(t=30.0\)</span> against the histograms you got from the random walks (remembering to also scale the density of the random walks histograms like <code class="docutils literal notranslate"><span class="pre">plt.hist(mywalk_step2,bins=50,density=True)</span></code>.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-3-two-dimensional-random-walks">
<h2>Exercise 3:  Two Dimensional Random Walks<a class="headerlink" href="#exercise-3-two-dimensional-random-walks" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>a. Simulating a Random Walk<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Let us now work with a two-dimensional random walk.   Starting at <span class="math notranslate nohighlight">\(x=(0,0)\)</span> generate 5 two-dimensional gaussian random walks with a <span class="math notranslate nohighlight">\(\sigma=6\)</span> each of 5000 steps.  Plot <span class="math notranslate nohighlight">\(y\)</span> vs <span class="math notranslate nohighlight">\(x\)</span> for these 5 walks.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-self-similarity">
<h3>b. Self Similarity<a class="headerlink" href="#b-self-similarity" title="Link to this heading">#</a></h3>
<p>Brownian random walks are self-similar. As you zoom into pieces of the figure, it looks qualitatively the same on all scales.
Make a random walk of 128,000 steps.  Then plot (on separate plots)</p>
<ul class="simple">
<li><p>the random walk</p></li>
<li><p>the first half of the random walk (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 2)</p></li>
<li><p>the first quarter of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 4)</p></li>
<li><p>the first eighth of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 8)</p></li>
<li><p>the first 1/16 of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 16)</p></li>
<li><p>the first 1/32 of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 32)</p></li>
</ul>
<p>Notice that these plots all look qualitatively similar. This is what I get:</p>
 <div><img src="https://clark.physics.illinois.edu/246img/selfSimilar.png" width=500 alt="RW"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-standard-deviation">
<h3>c. Standard Deviation<a class="headerlink" href="#c-standard-deviation" title="Link to this heading">#</a></h3>
<p>Like in the 1D case, we expect the average <span class="math notranslate nohighlight">\(\langle x_k \rangle\)</span> to be zero.  Let’s just go ahead and plot the standard deviation</p>
<div class="math notranslate nohighlight">
\[\langle \sigma \rangle = \langle \sqrt{x_k^2 + y_k^2}  \rangle\]</div>
<p><em>for 1000 copies of the gaussian plot.</em></p>
<p>You should obtain a similar curve to that obtained in the one-dimensional case, but increased somewhat in amplitude.  Even in two-dimensions, the displacement goes with the square root of time. <strong>Show this by also plotting it on a log-log plot and fitting the slope</strong>.</p>
<p>It turns out that you also see this behavior in three dimensions. In general, the standard deviation always scales as the square root of time for any physical system undergoing diffusive motion.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="d-animation-extra-credit-5-points">
<h3>d.  Animation (extra credit: 5 points)<a class="headerlink" href="#d-animation-extra-credit-5-points" title="Link to this heading">#</a></h3>
<p>Animate the two-dimensional random walk.  You may find the animation code from previous exercise helpful.</p>
</section>
</section>
<section id="exercise-3-diffusion-limited-aggregation">
<h2>Exercise 3: Diffusion Limited Aggregation<a class="headerlink" href="#exercise-3-diffusion-limited-aggregation" title="Link to this heading">#</a></h2>
<p>In the previous exercises we learned some properties of random walks.  In this exercise, we will apply random walks to the application of deposition.  This will be done by modeling it with diffusion limited aggregation (DLA).</p>
<section id="a-dla-onto-a-core-point-at-the-origin">
<h3>a. DLA onto a core point at the origin<a class="headerlink" href="#a-dla-onto-a-core-point-at-the-origin" title="Link to this heading">#</a></h3>
<p>In DLA, we do the following:</p>
<ul class="simple">
<li><p>Start with a particle at some fixed point (say the center of a box).</p></li>
<li><p>Repeat the following:</p>
<ul>
<li><p>Add a new particle someplace on the boundary (anywhere on the four walls).</p></li>
<li><p>Move this particle using a discrete random walk (left, right, up, down).  If it tries to move in the direction of one of the walls, it shouldn’t stick (but also shouldn’t go anywhere).</p></li>
<li><p>Once it is touching (up or down or left or right) a currently stuck particle, it should stick.</p></li>
</ul>
</li>
</ul>
<p>To accomplish this, I kept a two-dimensional numpy array which kept track of the location of the stuck particles and the currently moving particle.</p>
<p>At the end, you want to go ahead and plot the location of your stuck particles.  To do this, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is your numpy grid.</p>
<p>Start with a box of size <span class="math notranslate nohighlight">\(100 \times 100\)</span>.<br />
Use 1000 different particles.</p>
<p>This simulation is a little slow.  On colab, it takes me approximately 2 minutes.  For testing you might want to turn down the number of different particles that you use.</p>
<p>It also also interesting to see the picture when you have a larger box (<span class="math notranslate nohighlight">\(200 \times 200\)</span>) but this is much slower (and not required as part of the assignment).</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-dla-onto-a-surface-extra-credit-5-points">
<h3>b. DLA onto a surface (extra credit: 5 points)<a class="headerlink" href="#b-dla-onto-a-surface-extra-credit-5-points" title="Link to this heading">#</a></h3>
<p>In the previous section you did DLA onto a core point.  If you are interested in understanding deposition onto a surface, you want to modify your DLA to come in at the top and stick either at the bottom or if they hit any previously stuck point.  Implement this.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-4-symmetry-restoration">
<h2>Exercise 4: Symmetry Restoration<a class="headerlink" href="#exercise-4-symmetry-restoration" title="Link to this heading">#</a></h2>
<section id="a-one-dimensional-discrete-walks">
<h3>a. One dimensional Discrete Walks<a class="headerlink" href="#a-one-dimensional-discrete-walks" title="Link to this heading">#</a></h3>
<p>So far we’ve been doing random walks with gaussian steps.  We would like to see what changes if instead we did discrete walks - i.e. at each step we are going to walk either left exactly 6 units or right exactly 6 units.</p>
<p>Write code to do this random walk and then print the histogram on separate plots at</p>
<ul class="simple">
<li><p>2 steps (with the gaussian histogram on top of it)</p></li>
<li><p>100 steps (with the gaussian histogram on top of it).</p></li>
</ul>
<p>i.e. for the 2 step histogram I wrote</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">locs_discrete</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">locs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>For the 2 step histogram you should see a qualitative difference.  But once you get to 100 steps, it seems that there is no dependence on the distribution for either the discrete or gaussian steps.  This is a form of universality (and something we will see even more starkly in the two-dimensional case below).</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-rotational-invariance-in-2d">
<h3>b. Rotational Invariance in 2D<a class="headerlink" href="#b-rotational-invariance-in-2d" title="Link to this heading">#</a></h3>
<p>Now we are going to show that in the 2D case, the discrete walks restore the rotational invariance of the gaussian walk.</p>
<p>To do this, we want to put the location of the 2000 2d coordinates at t=1000 steps.</p>
<p>Do this for both the discrete and guassian walks.</p>
<p>You should see that</p>
<p>(1) They look the same and</p>
<p>(2) More interestingly, the discrete case looks rotationally invariant (like a circle) even though it can only go up, down, left, right.   This is an  emergent rotational symmetry.</p>
  <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Answer Here</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p><strong>Acknowledgements</strong></p>
<ul class="simple">
<li><p>Problems 1,2,3,4: Bryan Clark (original)</p></li>
<li><p>A different but related verision of problems 1(ab) and 3(ac) existed in an earlier version by George Gollin and Ryan Levy and Eli Chertkov</p></li>
<li><p>A similar version of problem 4 exists in James Sethna’s statistical mechanics textbook.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MachineLearningGalaxies.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Classifying Galaxies</p>
      </div>
    </a>
    <a class="right-next"
       href="Markov%20Chains.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Markov Chains</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-unbiased-random-walks">Exercise 1: Unbiased Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simulating-a-random-walk">a. Simulating a random walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-random-walk-averages">b. Random Walk Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-the-full-distribution">c. The Full Distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-modeling-the-diffusion-deterministically">Exercise 2:  Modeling the diffusion deterministically</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-representing-the-initial-distribution">a. Representing the initial distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-time-evolving-the-distribution">b.  Time evolving the distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-two-dimensional-random-walks">Exercise 3:  Two Dimensional Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">a. Simulating a Random Walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-self-similarity">b. Self Similarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-standard-deviation">c. Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-animation-extra-credit-5-points">d.  Animation (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-diffusion-limited-aggregation">Exercise 3: Diffusion Limited Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-dla-onto-a-core-point-at-the-origin">a. DLA onto a core point at the origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-dla-onto-a-surface-extra-credit-5-points">b. DLA onto a surface (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-symmetry-restoration">Exercise 4: Symmetry Restoration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-one-dimensional-discrete-walks">a. One dimensional Discrete Walks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rotational-invariance-in-2d">b. Rotational Invariance in 2D</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark; George Gollin; Ryan Levy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>